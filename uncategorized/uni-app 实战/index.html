<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-flash.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/errorje-32x32.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/errorje-16x16.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="[TOC] 一、项目基础配置1 HBuilderX 工具对 uni-app 支持很好，一些 API 都不用去查，你只需要知道有这个东西，在写的时候会自动提示。 如输入 ulist 就会提示生成 Uniapp 的 list 组件。  若新增了文件，则必须重新编译。  2 开发平台第三方的开发能力，实际上就是在各个开发者平台去拿到 appid 和 appscret. 花点钱去认证开发者资格在启平台创建">
<meta property="og:type" content="article">
<meta property="og:title" content="uni-app 实战">
<meta property="og:url" content="http://yoursite.com/uncategorized/uni-app 实战/index.html">
<meta property="og:site_name" content="前端技术研究所">
<meta property="og:description" content="[TOC] 一、项目基础配置1 HBuilderX 工具对 uni-app 支持很好，一些 API 都不用去查，你只需要知道有这个东西，在写的时候会自动提示。 如输入 ulist 就会提示生成 Uniapp 的 list 组件。  若新增了文件，则必须重新编译。  2 开发平台第三方的开发能力，实际上就是在各个开发者平台去拿到 appid 和 appscret. 花点钱去认证开发者资格在启平台创建">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-08-15T05:41:07.316Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="uni-app 实战">
<meta name="twitter:description" content="[TOC] 一、项目基础配置1 HBuilderX 工具对 uni-app 支持很好，一些 API 都不用去查，你只需要知道有这个东西，在写的时候会自动提示。 如输入 ulist 就会提示生成 Uniapp 的 list 组件。  若新增了文件，则必须重新编译。  2 开发平台第三方的开发能力，实际上就是在各个开发者平台去拿到 appid 和 appscret. 花点钱去认证开发者资格在启平台创建">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/uncategorized/uni-app 实战/">





  <title>uni-app 实战 | 前端技术研究所</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?6564c438b505c8f85a519ffff02cd1c8";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">前端技术研究所</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            全部文章
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/uncategorized/uni-app 实战/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ErrorJE">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/errorje.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="前端技术研究所">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">uni-app 实战</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-15T13:37:21+08:00">
                2019-08-15
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2019-08-15T13:41:07+08:00">
                2019-08-15
              </time>
            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/uncategorized/uni-app 实战/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count gitment-comments-count" data-xid="/uncategorized/uni-app 实战/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o">已阅读</i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span><i> 次</i>
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  10.5k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  48
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>[TOC]</p>
<h1 id="一、项目基础配置"><a href="#一、项目基础配置" class="headerlink" title="一、项目基础配置"></a>一、项目基础配置</h1><h3 id="1-HBuilderX-工具"><a href="#1-HBuilderX-工具" class="headerlink" title="1 HBuilderX 工具"></a>1 HBuilderX 工具</h3><p>对 uni-app 支持很好，一些 API 都不用去查，你只需要知道有这个东西，在写的时候会自动提示。</p>
<p>如输入 <code>ulist</code> 就会提示生成 Uniapp 的 list 组件。</p>
<blockquote>
<p>若新增了文件，则必须重新编译。</p>
</blockquote>
<h3 id="2-开发平台"><a href="#2-开发平台" class="headerlink" title="2 开发平台"></a>2 开发平台</h3><p>第三方的开发能力，实际上就是在各个开发者平台去拿到 appid 和 appscret.</p>
<p>花点钱去认证开发者资格在启平台创建APP应用，就能拿到这些。如微信开放平台。</p>
<blockquote>
<p>不同 API 支持不同的平台，此时需要圈起来不然在某一个不支持的平台会报错。</p>
</blockquote>
<h3 id="3-套路样式说明"><a href="#3-套路样式说明" class="headerlink" title="3 套路样式说明"></a>3 套路样式说明</h3><h4 id="1）全局样式"><a href="#1）全局样式" class="headerlink" title="1）全局样式"></a>1）全局样式</h4><p>在 App.vue 中设定， 应用于各个页面的根视图容器组件 <code>&lt;view class=&quot;page&quot;&gt;&lt;/view&gt;</code></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.page</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>:<span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>:<span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background-color</span>:<span class="number">#f7f7f7</span>;</span><br><span class="line">  <span class="attribute">position</span>:absolute;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2）引入外部样式"><a href="#2）引入外部样式" class="headerlink" title="2）引入外部样式"></a>2）引入外部样式</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在一个页面文件夹中，除了 .vue 还可以有 css 文件</span></span><br><span class="line">@<span class="keyword">import</span> url(<span class="string">"xx.css"</span>) <span class="comment">// 在.vue 的 style 标签中引入该样式文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 背景图片， 一定是外部网络图</span></span><br><span class="line">background:url(https:<span class="comment">//xxxx)</span></span><br></pre></td></tr></table></figure>

<h4 id="3）文字超出省略显示"><a href="#3）文字超出省略显示" class="headerlink" title="3）文字超出省略显示"></a>3）文字超出省略显示</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.text &#123;</span><br><span class="line">	white-space:nowrap;</span><br><span class="line">	overflow:hidden;</span><br><span class="line">	text-overflow:ellipsis;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4）flex-嵌套布局"><a href="#4）flex-嵌套布局" class="headerlink" title="4）flex 嵌套布局"></a>4）flex 嵌套布局</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>:flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>:column;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.son</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>:flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>:row;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5）阴影实现"><a href="#5）阴影实现" class="headerlink" title="5）阴影实现"></a>5）阴影实现</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.block</span> &#123;</span><br><span class="line">  box-shadow:3px 2px 10px #dedede; // x/y 偏移量，模糊程度，颜色</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h1 id="二、框架基础"><a href="#二、框架基础" class="headerlink" title="二、框架基础"></a>二、框架基础</h1><h2 id="（一）项目结构与文件类型（MVVM思想）"><a href="#（一）项目结构与文件类型（MVVM思想）" class="headerlink" title="（一）项目结构与文件类型（MVVM思想）"></a>（一）项目结构与文件类型（MVVM思想）</h2><h3 id="1-MVC"><a href="#1-MVC" class="headerlink" title="1 MVC"></a>1 MVC</h3><p>用户操作页面（view），处理用户请求（controller路由+控制器），增删改查（数据层model）</p>
<h3 id="2-MVVC"><a href="#2-MVVC" class="headerlink" title="2 MVVC"></a>2 MVVC</h3><p>之前，数据（JSON）通过 JS/JQ 操作DOM更改视图。</p>
<p>现在，用 viewModel 调度，当Model发生变化，视图同时改变，或反向（数据双向绑定）</p>
<h3 id="3-数据双向绑定"><a href="#3-数据双向绑定" class="headerlink" title="3 数据双向绑定"></a>3 数据双向绑定</h3><h4 id="1）项目结构"><a href="#1）项目结构" class="headerlink" title="1）项目结构"></a>1）项目结构</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">- components 自定义组件目录</span><br><span class="line">- pages 页面目录</span><br><span class="line">- - .vue 单页面组件</span><br><span class="line">- - - template HTML模板，就是view层</span><br><span class="line">- - - script 就是 VM 协调者。其中的data属性就是 model</span><br><span class="line">- - - style</span><br><span class="line">- common 存放 css 等资源</span><br><span class="line">- <span class="keyword">static</span> 存放图片等静态资源</span><br><span class="line">- store Vuex</span><br><span class="line">- unpackage 打包目录</span><br><span class="line">- App.vue 根组件，全局样式、应用级生命周期</span><br><span class="line">- main.js 入口文件，全局变量</span><br><span class="line">- manifes.json 各个平台的打包配置</span><br><span class="line">- pages 页面路由和基本配置</span><br></pre></td></tr></table></figure>

<h4 id="2）双向绑定"><a href="#2）双向绑定" class="headerlink" title="2）双向绑定"></a>2）双向绑定</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;view&gt;</span><br><span class="line">  &lt;!-- 2 &#123;&#123;title&#125;&#125; 绑定数据 --&gt;</span><br><span class="line">  &lt;!-- 3 :value 绑定变量 --&gt;</span><br><span class="line">  &lt;!-- 4 @change 绑定事件 --&gt;</span><br><span class="line">  &lt;text&gt;&#123;&#123;title&#125;&#125;&lt;/text&gt;</span><br><span class="line">  &lt;input type=&quot;text&quot; :value=&quot;title&quot; @change=&quot;change&quot;&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        title:&apos;wjy1&apos; // 1 定义数据</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      change(e)&#123;</span><br><span class="line">        // 5 拿到事件对象和值</span><br><span class="line">        console.log(e.detail.value)</span><br><span class="line">        // 6 改写 title 变量</span><br><span class="line">        this.title = e.detail.value</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="（二）全局（页面）标题（样式）与路由配置"><a href="#（二）全局（页面）标题（样式）与路由配置" class="headerlink" title="（二）全局（页面）标题（样式）与路由配置"></a>（二）全局（页面）标题（样式）与路由配置</h2><h3 id="1-路由配置"><a href="#1-路由配置" class="headerlink" title="1 路由配置"></a>1 路由配置</h3><p>创建页面，pages/index/index.vue ，会自动到 <code>pages</code> 中添加该页面路由</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">"pages":[ // 数组第一项为启动页</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"path"</span>:'pages/xxxx',</span><br><span class="line">    <span class="attr">"style"</span>:&#123;&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="2-页面标题"><a href="#2-页面标题" class="headerlink" title="2 页面标题"></a>2 页面标题</h3><p>配置在路由的 style 中</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">"pages":[ </span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"path"</span>:'pages/xxxx',</span><br><span class="line">    <span class="attr">"style"</span>:&#123;</span><br><span class="line">      <span class="attr">"navigationBarTitleText"</span>:<span class="string">"该页面标题"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="3-全局标题"><a href="#3-全局标题" class="headerlink" title="3 全局标题"></a>3 全局标题</h3><p>在 “globalStyle” 属性中</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">"globalStyle": &#123;</span><br><span class="line">  "navigationBarTextStyle": "black", // 导航栏颜色[black, white]</span><br><span class="line">  "navigationBarTitleText": "Hello uniapp", // 导航栏标题</span><br><span class="line">  "navigationBarBackgroundColor": "#F8F8F8", // 导航栏背景颜色</span><br><span class="line">  "backgroundColor": "#F8F8F8", // 窗口背景色</span><br><span class="line">  "backgroundColorTop": "#F4F5F6",</span><br><span class="line">  "backgroundColorBottom": "#F4F5F6",</span><br><span class="line">  "mp-alipay": &#123;</span><br><span class="line">    "titleBarColor": "#FFFFFF"</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="4-开启下拉刷新和触底分页-配合-Loading"><a href="#4-开启下拉刷新和触底分页-配合-Loading" class="headerlink" title="4 开启下拉刷新和触底分页(配合 Loading)"></a>4 开启下拉刷新和触底分页(配合 Loading)</h3><h4 id="1）Pages-json-开启页面的-style-属性"><a href="#1）Pages-json-开启页面的-style-属性" class="headerlink" title="1）Pages.json 开启页面的 style 属性"></a>1）Pages.json 开启页面的 style 属性</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">"pages": [ </span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"path"</span>: <span class="string">"pages/index/index"</span>,</span><br><span class="line">    <span class="attr">"style"</span>: &#123;</span><br><span class="line">      <span class="attr">"navigationBarTitleText"</span>: <span class="string">"uni-app"</span>,</span><br><span class="line">      <span class="attr">"h5"</span>:&#123;</span><br><span class="line">        <span class="attr">"titleNView"</span>:<span class="literal">false</span></span><br><span class="line">      &#125;,</span><br><span class="line">      "enablePullDownRefresh":true, // 下拉刷新</span><br><span class="line">      "onReachBottomDistance":true // 触底分页</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">],</span><br></pre></td></tr></table></figure>

<h4 id="2）页面中增加响应事件和-loading"><a href="#2）页面中增加响应事件和-loading" class="headerlink" title="2）页面中增加响应事件和 loading"></a>2）页面中增加响应事件和 loading</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  onPullDownRefresh()&#123;</span><br><span class="line">    <span class="comment">// 1 开启loading。 在小程序等原生顶部栏也有loading，执行 uin.showNavigationBarLoading()</span></span><br><span class="line">    uni.showLoading(&#123;</span><br><span class="line">      mask:<span class="literal">true</span>, <span class="comment">// 遮罩防止用户点击</span></span><br><span class="line">      title:<span class="string">"请稍后..."</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 2 重新请求方法</span></span><br><span class="line">    <span class="comment">// 3 注意在请求 complate 回调中要关闭 Loading 动画，执行 uni.stopPullDownRefresh()</span></span><br><span class="line">    <span class="comment">// 还有 uni.hideLoading() 或 uni.hideNavigationBarLoading()</span></span><br><span class="line">  &#125;,</span><br><span class="line">  onReachBottom()&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-沉浸渐进式标题导航栏"><a href="#5-沉浸渐进式标题导航栏" class="headerlink" title="5 沉浸渐进式标题导航栏"></a>5 沉浸渐进式标题导航栏</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">"pages": [ </span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"path"</span>: <span class="string">"pages/index/index"</span>,</span><br><span class="line">    <span class="attr">"style"</span>: &#123;</span><br><span class="line">      <span class="attr">"navigationBarTitleText"</span>: <span class="string">"uni-app"</span>,</span><br><span class="line">      <span class="attr">"app-plus"</span>:&#123;</span><br><span class="line">        <span class="attr">"titleNView"</span>:&#123;</span><br><span class="line">          	<span class="attr">"type"</span>:<span class="string">"transparent"</span> // 页面滑动，顶部导航栏有透明效果</span><br><span class="line">     		 &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">],</span><br></pre></td></tr></table></figure>

<h3 id="6-顶部导航栏"><a href="#6-顶部导航栏" class="headerlink" title="6 顶部导航栏"></a>6 顶部导航栏</h3><h4 id="1）顶部导航栏"><a href="#1）顶部导航栏" class="headerlink" title="1）顶部导航栏"></a>1）顶部导航栏</h4><p>H5，APP可能并不需要顶部导航栏，所以可以去掉， 也是在 <code>pages.json</code>中对某个页面的路由 <code>style</code>属性进行设置（微信小程序是去不掉的）。</p>
<p>其他端增加这个导航栏，需要调整上边距</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">"path": "pages/index/index",</span><br><span class="line">"style": &#123;</span><br><span class="line">  "navigationBarTitleText": "uni-app",</span><br><span class="line">  “navigationBarTitleStyle:'white', // 只有 white / black</span><br><span class="line">  "navigationBarBackgroundColor":'#ffd655',</span><br><span class="line">  "h5":&#123; // 设置 app-plus 也会应用到 H5，反之则覆盖</span><br><span class="line">    "titleNView":false</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2）顶部自定义按钮"><a href="#2）顶部自定义按钮" class="headerlink" title="2）顶部自定义按钮"></a>2）顶部自定义按钮</h4><blockquote>
<p>配合页面生命周期，监听标题栏按钮点击事件</p>
</blockquote>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">"path": "pages/index/index",</span><br><span class="line">"style": &#123;</span><br><span class="line">  "navigationBarTitleText": "uni-app",</span><br><span class="line">  "h5":&#123; </span><br><span class="line">    "titleNView":&#123;</span><br><span class="line">      "type":"transparent", // 透明渐变</span><br><span class="line">      "buttons":[</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"type"</span>:<span class="string">"share"</span> // 分享</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"type"</span>:<span class="string">"home"</span> // 主页</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"type"</span>:<span class="string">"forward"</span> // 前进</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>监听标题栏按钮事件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">onNavigationBarButtonTap(e)&#123;</span><br><span class="line">  <span class="keyword">const</span> index = e.index <span class="comment">// 判断 index 值就行</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>分享到朋友圈（H5不支持）, 其他小程序平台需要配置分享时的appid信息</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">uni.share(&#123;</span><br><span class="line">  provider:<span class="string">'weixin'</span>,</span><br><span class="line">  scene:<span class="string">'WXSenceTimeline'</span>,</span><br><span class="line">  type:<span class="number">0</span>,</span><br><span class="line">  href:<span class="string">""</span>,</span><br><span class="line">  title:<span class="string">"uni-app分享"</span>,</span><br><span class="line">  summary:<span class="string">"我正在与你分享"</span>,</span><br><span class="line">  imageUrl:<span class="string">"xxx"</span>,</span><br><span class="line">  success:<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;,</span><br><span class="line">  fail:<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="（三）App（页面）的生命周期"><a href="#（三）App（页面）的生命周期" class="headerlink" title="（三）App（页面）的生命周期"></a>（三）App（页面）的生命周期</h2><h3 id="1-应用生命周期"><a href="#1-应用生命周期" class="headerlink" title="1 应用生命周期"></a>1 应用生命周期</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">onLaunch 初始化全局只触发一次</span><br><span class="line">onShow 页面展示就触发</span><br><span class="line">onHide 页面隐藏就触发</span><br><span class="line">onUniNViewMessage 对 nvue 页面发送的数据进行监听</span><br></pre></td></tr></table></figure>

<h3 id="2-页面生命周期"><a href="#2-页面生命周期" class="headerlink" title="2 页面生命周期"></a>2 页面生命周期</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">onLoad 监听页面加载，参数为上个页面的传参</span><br><span class="line">onUnload 监听页面卸载</span><br><span class="line">onShow 页面显示</span><br><span class="line">onHide 页面隐藏</span><br><span class="line">onReady 页面初次渲染完成</span><br><span class="line"></span><br><span class="line">onPullDownRefresh 下拉事件。用于下拉刷新</span><br><span class="line">onReachBottom 触底。分页操作</span><br><span class="line">onNavigationBarButtonTap 原生页面标题按钮点击事件，参数是 obj</span><br><span class="line">onBackPress 监听页面返回</span><br></pre></td></tr></table></figure>

<h3 id="3-页面跳转组件"><a href="#3-页面跳转组件" class="headerlink" title="3 页面跳转组件"></a>3 页面跳转组件</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">"../index/index"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">view</span>&gt;</span>xxx<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="（四）数据绑定与事件和组件动静态变量"><a href="#（四）数据绑定与事件和组件动静态变量" class="headerlink" title="（四）数据绑定与事件和组件动静态变量"></a>（四）数据绑定与事件和组件动静态变量</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 1 动态绑定属性变量 v-bind:或 :</span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">:text:</span>"<span class="attr">text</span>"&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// 2 事件绑定, tap 会覆盖 click 事件， longtap 替代 longpress</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> @<span class="attr">input</span>=<span class="string">"change"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="（五）条件和列表渲染语法"><a href="#（五）条件和列表渲染语法" class="headerlink" title="（五）条件和列表渲染语法"></a>（五）条件和列表渲染语法</h2><h3 id="1-条件渲染"><a href="#1-条件渲染" class="headerlink" title="1 条件渲染"></a>1 条件渲染</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// 1 v-if 条件渲染</span><br><span class="line">&lt;tempalte v-if=&quot;isShow&quot;&gt;&lt;/tempalte&gt;</span><br><span class="line">&lt;tempalte v-else-if=&quot;!isShow&quot;&gt;&lt;/tempalte&gt;</span><br><span class="line">&lt;tempalte v-else&gt;&lt;/tempalte&gt;</span><br><span class="line">// 2 v-show 控制的是 display 属性 DOM 是存在的。</span><br><span class="line">&lt;tempalte v-show=&quot;isShow&quot;&gt;&lt;/tempalte&gt;</span><br><span class="line">// 3 三元运算</span><br><span class="line">&lt;tempalte v-if=&quot;sex === 1 ? true: false&quot;&gt;男&lt;/tempalte&gt;</span><br><span class="line">&lt;tempalte v-if=&quot;sex === 0 ? true: false&quot;&gt;女&lt;/tempalte&gt;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">		data() &#123;</span><br><span class="line">			return &#123;</span><br><span class="line">				isShow:true,</span><br><span class="line">				sex:1</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-列表渲染"><a href="#2-列表渲染" class="headerlink" title="2 列表渲染"></a>2 列表渲染</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// 1 v-for 列表渲染</span><br><span class="line">// 2 :key 确保数据唯一性。防止如数组头部增加这样的操作</span><br><span class="line">&lt;view&gt;</span><br><span class="line">	&lt;view v-for=&quot;(item, index) in arr&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">  	&lt;view&gt;姓名&#123;&#123;item.name&#125;&#125;&lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">		data() &#123;</span><br><span class="line">			return &#123;</span><br><span class="line">				arr:[</span><br><span class="line">					&#123;id:1,name:&apos;wjy&apos;, age:12&#125;,</span><br><span class="line">					&#123;&#125;</span><br><span class="line">				]</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="（六）多端兼容条件编译"><a href="#（六）多端兼容条件编译" class="headerlink" title="（六）多端兼容条件编译"></a>（六）多端兼容条件编译</h2><h3 id="1-基本语义"><a href="#1-基本语义" class="headerlink" title="1 基本语义"></a>1 基本语义</h3><ul>
<li><code>#ifdef</code> 仅某平台存在</li>
<li><code>#ifndef</code>，除了某平台均存在</li>
<li><code>%PLATFORM%</code>平台名称</li>
<li><code>endif</code>结束标识</li>
</ul>
<h3 id="2-平台类别"><a href="#2-平台类别" class="headerlink" title="2 平台类别"></a>2 平台类别</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">APP-PLUS</span><br><span class="line">APP-PLUS-NVUE</span><br><span class="line">H5</span><br><span class="line">MP-WEIXIN</span><br><span class="line">MP-ALIPAY</span><br><span class="line">MP-BAIDU</span><br><span class="line">MP</span><br></pre></td></tr></table></figure>

<h3 id="3-使用方式"><a href="#3-使用方式" class="headerlink" title="3 使用方式"></a>3 使用方式</h3><p>JS, CSS, HTML, JSON 文件中都可以使用。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- #ifdef H5 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>H5端<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- #endif --&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="三、组件"><a href="#三、组件" class="headerlink" title="三、组件"></a>三、组件</h1><h2 id="（一）普通官网组件"><a href="#（一）普通官网组件" class="headerlink" title="（一）普通官网组件"></a>（一）普通官网组件</h2><h3 id="1-tabBar-底部栏"><a href="#1-tabBar-底部栏" class="headerlink" title="1 tabBar 底部栏"></a>1 tabBar 底部栏</h3><p>配置 <code>pages.json</code> 的 “tabBar” 属性，定义基本的选中/非选中颜色，然后配置<code>list</code>的tab数组。</p>
<h3 id="2-view-视图组件"><a href="#2-view-视图组件" class="headerlink" title="2 view 视图组件"></a>2 view 视图组件</h3><p>也是必备的，也是通用组件</p>
<h3 id="3-swiper-轮播图组件"><a href="#3-swiper-轮播图组件" class="headerlink" title="3 swiper 轮播图组件"></a>3 swiper 轮播图组件</h3><p>就给出几个常用的属性, swiper-item 在 swiper 组件中宽高自动为 100%, 但是图片可能没有填满，所以要对图片进行CSS设置。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">swiper</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:autoplay</span>=<span class="string">"true"</span> 自动切换</span></span><br><span class="line"><span class="tag">        <span class="attr">:indecator-dots</span>=<span class="string">"true"</span> 显示指示点</span></span><br><span class="line"><span class="tag">        <span class="attr">vertical:false</span> 是否纵向滑动 </span></span><br><span class="line"><span class="tag">        <span class="attr">current</span> 当前滑块所在 <span class="attr">index</span> <span class="attr">0</span> 开始</span></span><br><span class="line"><span class="tag">        @<span class="attr">change</span> 滑块变化时触发</span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">swiper-item</span>&gt;</span><span class="tag">&lt;<span class="name">view</span>&gt;</span>xxx<span class="tag">&lt;/<span class="name">view</span>&gt;</span><span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">swiper-item</span>&gt;</span><span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">"xxx"</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span><span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">swiper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-scroll-view-滚动区域"><a href="#4-scroll-view-滚动区域" class="headerlink" title="4 scroll-view 滚动区域"></a>4 scroll-view 滚动区域</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">scroll-x 横向</span><br><span class="line">scroll-y 允许纵向滚动</span><br><span class="line">upper-threshold 距离顶部/左边 xx 距离，触发 @scrolltoupper 事件</span><br><span class="line">lower-threshold 距离底部/右边 xx 距离，触发 @scrolltolower 事件</span><br><span class="line">@scroll 滚动事件</span><br><span class="line">scroll-top(left) 设置竖向/横向滚动条位置 </span><br><span class="line">scroll-into-view 值为某子元素 id(不能以数字开头)，设置哪个方向可滚动，则在哪个方向滚动到该元素</span><br></pre></td></tr></table></figure>

<p>需要对其中的元素进行样式设定</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.hot</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>:<span class="number">100%</span>;</span><br><span class="line">  white-space:nowrap; 不换行</span><br><span class="line">&#125;</span><br><span class="line">// 横向的话，可能还要更改元素的 display:inline-block</span><br></pre></td></tr></table></figure>

<h3 id="5-video-视频组件"><a href="#5-video-视频组件" class="headerlink" title="5 video 视频组件"></a>5 video 视频组件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">src 资源地址</span><br><span class="line">loop 是否循环播放</span><br><span class="line">muted 是否静音播放</span><br><span class="line">initial-time 初始播放位置秒</span><br><span class="line">duration 视频时长</span><br><span class="line">controls 是否显示播放控件（播放、暂停、进度、时间）</span><br><span class="line">// 弹幕相关</span><br><span class="line">page-gesture 非全屏模式下，是否开始亮度与音量调节手势</span><br></pre></td></tr></table></figure>

<h4 id="1）切页时的视频控制-uni-createVideoContext"><a href="#1）切页时的视频控制-uni-createVideoContext" class="headerlink" title="1）切页时的视频控制 uni.createVideoContext"></a>1）切页时的视频控制 uni.createVideoContext</h4><p>当我们点开图片之类的，希望视频暂停（H5上是跳转页面，所以不存在继续播放的问题）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1 页面进来获得视频对象</span></span><br><span class="line">onReady()&#123;</span><br><span class="line">  <span class="keyword">this</span>.videoContext = uni.createVideoContext(<span class="string">'id'</span>) <span class="comment">// 根据视频标签上的 id 属性获得</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2 当播放页面隐藏，视频暂停</span></span><br><span class="line">onHide()&#123;</span><br><span class="line">  <span class="keyword">this</span>.videoContext.pause()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 3 继续播放</span></span><br><span class="line">onShow()&#123;</span><br><span class="line">  <span class="comment">// 判断有效性，因为第一次进来是没这个对象的</span></span><br><span class="line">  <span class="keyword">this</span>.videoContext &amp;&amp; <span class="keyword">this</span>.videoContext.play()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2）禁止视频同时播放"><a href="#2）禁止视频同时播放" class="headerlink" title="2）禁止视频同时播放"></a>2）禁止视频同时播放</h4><p>给每个视频 video 增加 id 属性和自定义属性（两个属性值是一样的，用于标识视频和播放视频），绑定 @play 事件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 只能播放一个视频</span></span><br><span class="line">play(e) &#123;</span><br><span class="line">  <span class="keyword">const</span> that = <span class="keyword">this</span></span><br><span class="line">  <span class="keyword">const</span> id = <span class="string">''</span></span><br><span class="line">  <span class="comment">// 当前播放视频的id</span></span><br><span class="line">  <span class="keyword">if</span> (e) &#123;</span><br><span class="line">    activeId = e.currentTarget.dataset.playindex</span><br><span class="line">    that.videoContext = uni.createVideoContext(activeId)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 遍历暂停其他视频</span></span><br><span class="line">  <span class="keyword">const</span> activeList = that.activeList</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;activeList.length; i++)&#123;</span><br><span class="line">    <span class="keyword">const</span> id = activeList[i].id</span><br><span class="line">    <span class="keyword">if</span>(id != activeId) &#123;</span><br><span class="line">      uni.createVideoContext(id).pause()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// onHide()&#123;&#125; 也要处理视频暂停</span></span><br></pre></td></tr></table></figure>

<h3 id="6-input-输入框"><a href="#6-input-输入框" class="headerlink" title="6 input 输入框"></a>6 input 输入框</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">value 值</span><br><span class="line">type 表单类型 [text文本, number数字, idcard 身份证, digit带小数数字]</span><br><span class="line">password 是否密码类型</span><br><span class="line">placeholder 空内容占位符</span><br><span class="line">disabled 是否禁用</span><br><span class="line">maxlength 输入最大长度， <span class="number">-1</span> 时不限制最大长度</span><br><span class="line">foucs 焦点</span><br><span class="line">adjust-position 键盘弹出是否上腿页面</span><br><span class="line">confirm-type 键盘右下角按钮文字，在 type=text 时有效, [search搜索]（通用）其他均为小程序用</span><br><span class="line">@input 输入</span><br><span class="line">@focus 聚焦</span><br><span class="line">@blur 失焦</span><br><span class="line">@confirm 点击完成按钮</span><br></pre></td></tr></table></figure>

<h3 id="7-image-图片资源"><a href="#7-image-图片资源" class="headerlink" title="7 image 图片资源"></a>7 image 图片资源</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">src 地址</span><br><span class="line">mode 裁剪、缩放模式 <span class="number">13</span> 种 [scaleToFill 完全适配, aspectFill保持纵横比缩放]</span><br><span class="line">lazy-load 揽件在。针对 page 和 scroll-view 下的 Image 有效</span><br></pre></td></tr></table></figure>

<h3 id="8-表单组件"><a href="#8-表单组件" class="headerlink" title="8 表单组件"></a>8 表单组件</h3><h4 id="1）按钮组件-button"><a href="#1）按钮组件-button" class="headerlink" title="1）按钮组件 button"></a>1）按钮组件 button</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">size 按钮大小 <span class="keyword">default</span>, mini</span><br><span class="line">type 按钮样式类型 [primary 蓝绿色, <span class="keyword">default</span> 白色, warn 红色]</span><br><span class="line">plain 按钮是否镂空，背景色是否透明</span><br><span class="line">disabled 是否禁用</span><br><span class="line">form-type 用于 form 组件，设置后，点击会触发 submit/reset 事件</span><br><span class="line">hover-class 按下去的样式类, 设置为"none"就没点击效果</span><br><span class="line">loading 设置<span class="literal">true</span>时就是表示加载交互了,js控制</span><br><span class="line">@getuserinfo 点击该按钮，会返回获取到的用户信息（微信小程序）</span><br></pre></td></tr></table></figure>

<h4 id="2）form-表单"><a href="#2）form-表单" class="headerlink" title="2）form 表单"></a>2）form 表单</h4><blockquote>
<p>用的话的，需要用 <form> 去包裹那些按钮之类的组件</form></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@submit, 携带 form 中的数据，拿到 event.detail = &#123;value:&#123;name:value&#125;, formid:&#125;</span><br><span class="line">@reset，表单重置触发</span><br></pre></td></tr></table></figure>

<p>实际使用 </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> @<span class="attr">submit</span>=<span class="string">"formSubmit"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">value</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">"input"</span> <span class="attr">placeholder</span>=<span class="string">"请输入用户名"</span> <span class="attr">placeholder-class</span>=<span class="string">"graywords"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"primary"</span> <span class="attr">form-type</span>=<span class="string">"submit"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">  methods:&#123;</span><br><span class="line">    formSubmit(e)&#123;</span><br><span class="line"><span class="javascript">      <span class="keyword">const</span> that = <span class="keyword">this</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">const</span> obj = e.detail.value <span class="comment">// &#123;&#125; 包含了在各个表单组件中 name 属性对应的表单值</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="（二）自定义组件"><a href="#（二）自定义组件" class="headerlink" title="（二）自定义组件"></a>（二）自定义组件</h2><blockquote>
<p>自定义组件可以理解为自定义标签</p>
</blockquote>
<h3 id="1-自定义组件的开发"><a href="#1-自定义组件的开发" class="headerlink" title="1 自定义组件的开发"></a>1 自定义组件的开发</h3><h4 id="1）创建组件"><a href="#1）创建组件" class="headerlink" title="1）创建组件"></a>1）创建组件</h4><p>在 <code>components</code>目录下直接创建，也是一个 .vue 单文件</p>
<h4 id="2）定义组件名称"><a href="#2）定义组件名称" class="headerlink" title="2）定义组件名称"></a>2）定义组件名称</h4><ul>
<li>在<code>template</code>根节点上加上 <code>name</code> 属性</li>
<li>在 script 部分的 <code>name</code>属性上写相同的组件名</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;template name=&quot;errorJe&quot;&gt;</span><br><span class="line">	&lt;view&gt;&#123;&#123;msg&#125;&#125;&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">	export default &#123;</span><br><span class="line">		name:&quot;errorJe&quot;,</span><br><span class="line">		data() &#123;</span><br><span class="line">			return &#123;</span><br><span class="line">				msg:&apos;自定义 errorje 组件&apos;</span><br><span class="line">			&#125;;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="3）使用自定义组件"><a href="#3）使用自定义组件" class="headerlink" title="3）使用自定义组件"></a>3）使用自定义组件</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1 导入组件，注意组件名</span></span><br><span class="line"><span class="keyword">import</span> errorJe <span class="keyword">from</span> <span class="string">'../../components/errorJe.vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      title: <span class="string">'Hello'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  onLoad() &#123;&#125;,</span><br><span class="line">  methods: &#123;&#125;,</span><br><span class="line">  components:&#123;</span><br><span class="line">    <span class="comment">// 2 在当前页面组件中注册导入的自定义组件</span></span><br><span class="line">    errorJe</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用自定义标签</span></span><br><span class="line">&lt;errorJe&gt;<span class="xml"><span class="tag">&lt;/<span class="name">errorJe</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="2-组件间传值"><a href="#2-组件间传值" class="headerlink" title="2 组件间传值"></a>2 组件间传值</h3><h4 id="1）父传子"><a href="#1）父传子" class="headerlink" title="1）父传子"></a>1）父传子</h4><ul>
<li>父组件通过子组件提供的元素属性传值<ul>
<li><code>:</code>绑定变量动态传值</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;errorJe msg=&quot;msg&quot; :auto=&quot;auto&quot;&gt;&lt;/errorJe&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>子组件通过<code>props</code>实例属性拿到值，每个自定义变量都是对象的形式定义</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  props:&#123;</span><br><span class="line">    msg:&#123;</span><br><span class="line">      type:<span class="built_in">String</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    showNum:<span class="number">0</span> <span class="comment">// 默认值</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="四、API"><a href="#四、API" class="headerlink" title="四、API"></a>四、API</h1><h3 id="1-发起请求-uni-request"><a href="#1-发起请求-uni-request" class="headerlink" title="1 发起请求 uni.request"></a>1 发起请求 uni.request</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 与小程序一样，调用 api 时要注意 this</span></span><br><span class="line"><span class="keyword">const</span> that = <span class="keyword">this</span></span><br><span class="line">uni.request(&#123;</span><br><span class="line">  url:<span class="string">''</span>,</span><br><span class="line">  method:<span class="string">"POST"</span>, <span class="comment">// 必须大写</span></span><br><span class="line">  data:&#123;</span><br><span class="line">    va1:xx</span><br><span class="line">  &#125;,</span><br><span class="line">  header: &#123;</span><br><span class="line">    <span class="string">"Content-Type"</span>: <span class="string">"application/json"</span>, <span class="comment">// 默认，可不写</span></span><br><span class="line">  &#125;,</span><br><span class="line">  dataType: <span class="string">'json'</span>,</span><br><span class="line">  success:<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 1 使用数据前，判断请求状态</span></span><br><span class="line">    res.data.status === <span class="number">200</span> &amp;&amp; (<span class="keyword">var</span> result = res.data.data)</span><br><span class="line">    <span class="comment">// 2 更新数据。如果使用的是箭头函数，可以直接使用 this</span></span><br><span class="line">    that.list = result</span><br><span class="line">  &#125;,</span><br><span class="line">  fail:<span class="function"><span class="params">err</span> =&gt;</span> &#123;&#125;,</span><br><span class="line">  complete:<span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 后端要求传参，但是前端给控制的 URL 传法</span></span><br><span class="line">url:<span class="string">"https://xxx.com?key=&amp;key2="</span></span><br></pre></td></tr></table></figure>

<h3 id="2-路由跳转-uni-navigateTo"><a href="#2-路由跳转-uni-navigateTo" class="headerlink" title="2 路由跳转 uni.navigateTo"></a>2 路由跳转 uni.navigateTo</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 可以通过 uni.navigateBack 返回原页面</span></span><br><span class="line">uni.navigateTo(&#123;</span><br><span class="line">  url:<span class="string">'test?id=1&amp;name=xx'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//  uni.switchTab 会关闭其他所有非 tab 页</span></span><br><span class="line">uni.switchTab(&#123;</span><br><span class="line">    url: <span class="string">'/pages/index/index'</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>会在下一个页面的 <code>onLoad</code> 中拿到参数s</p>
<h3 id="3-图片预览-uni-previewImage"><a href="#3-图片预览-uni-previewImage" class="headerlink" title="3 图片预览 uni.previewImage"></a>3 图片预览 uni.previewImage</h3><blockquote>
<p>需要在图片上绑定 @click</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">urls 预览图片链接数组</span><br><span class="line">current 当前显示图片链接，不填则默认 urls 第一张</span><br><span class="line">loop 是否循环预览</span><br><span class="line">indicator 图片指示器</span><br><span class="line">success/fail/complate</span><br></pre></td></tr></table></figure>

<h4 id="1）自定义预览组件实现"><a href="#1）自定义预览组件实现" class="headerlink" title="1）自定义预览组件实现"></a>1）自定义预览组件实现</h4><p>不用官方提供的预览，只有切换图片的效果。我们想自定义按钮、标题等。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">// cover.vue 组件</span><br><span class="line">&lt;tempalte&gt;</span><br><span class="line">  &lt;view class=&quot;black&quot;&gt;</span><br><span class="line">    &lt;image</span><br><span class="line">           :src=&quot;cover&quot;</span><br><span class="line">           class=&quot;cover&quot;</span><br><span class="line">           mode=&quot;widthFix&quot;</span><br><span class="line">           @longpress=&quot;operator&quot;</span><br><span class="line">           &gt;&lt;/image&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/tempalte&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name:&apos;errorImage&apos;,</span><br><span class="line">    data()&#123;</span><br><span class="line">      return &#123;</span><br><span class="line">				cover:&apos;&apos;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    onLoad(params)&#123;</span><br><span class="line">      let cover = params.cover</span><br><span class="line">      this.cover = cover // 父组件传来的图片 src</span><br><span class="line">      // 修改导航栏属性</span><br><span class="line">      uni.setNavigationBarColor(&#123;</span><br><span class="line">        frontColor:&quot;#ffffff&quot;,</span><br><span class="line">        backgroundColor:&apos;#000000&apos;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">  .black &#123;</span><br><span class="line">    background-color:#000000;</span><br><span class="line">    width:100%;</span><br><span class="line">    height:100%;</span><br><span class="line"></span><br><span class="line">    display:flex;</span><br><span class="line">    flex-direction:column;</span><br><span class="line">    justify-content:center;</span><br><span class="line">    position:fixed;</span><br><span class="line">  &#125;</span><br><span class="line">  .cover&#123;</span><br><span class="line">    align-self:center;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="2）路由跳转到自定义组件页面"><a href="#2）路由跳转到自定义组件页面" class="headerlink" title="2）路由跳转到自定义组件页面"></a>2）路由跳转到自定义组件页面</h4><blockquote>
<p>因为是采用路由跳转，自动加了返回的按钮</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;navigation :url=&quot;../../cover/cover?key=xx&quot;&gt;</span><br><span class="line">  &lt;image</span><br><span class="line">         :src=&quot;xxxx&quot;</span><br><span class="line">         class=&quot;xxx&quot;</span><br><span class="line">         &gt;&lt;/image&gt;</span><br><span class="line">&lt;/navigation&gt;</span><br></pre></td></tr></table></figure>

<h4 id="3）增加图片交互功能-uni-showActionSheet"><a href="#3）增加图片交互功能-uni-showActionSheet" class="headerlink" title="3）增加图片交互功能 uni.showActionSheet"></a>3）增加图片交互功能 uni.showActionSheet</h4><blockquote>
<p>显示操作菜单，增加一些按钮（最多6个），还有一个默认出现的 “取消”按钮</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 上面触发长按，执行 operator 方法</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">uni.showActionSheet(&#123;</span><br><span class="line">  itemList:[<span class="string">"下载"</span>, <span class="string">"aaa"</span>], <span class="comment">// 按钮文字数组</span></span><br><span class="line">  itemColor:<span class="string">'#000000'</span>,</span><br><span class="line">  success:<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;</span><br><span class="line">    e.tapIndex <span class="comment">// 按钮的位置</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="4-下载资源到本地"><a href="#4-下载资源到本地" class="headerlink" title="4 下载资源到本地"></a>4 下载资源到本地</h3><h4 id="1）下载资源-uni-downLoadFile-（跨域）"><a href="#1）下载资源-uni-downLoadFile-（跨域）" class="headerlink" title="1）下载资源 uni.downLoadFile （跨域）"></a>1）下载资源 uni.downLoadFile （跨域）</h4><p>下载资源到本地，客户端发起 GET 请求，返回文件的本地临时路径</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">url 资源路径</span><br><span class="line">success 下载成功后以临时文件路径的形式传给页面</span><br></pre></td></tr></table></figure>

<p>文件操作肯定是延迟的，所以配合 loading</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> url = url</span><br><span class="line">uni.showLoading(&#123;</span><br><span class="line">  title:<span class="string">'图片保存中...'</span></span><br><span class="line">&#125;)</span><br><span class="line">uni.downLoadFile(&#123;</span><br><span class="line">  url:url,</span><br><span class="line">  success:<span class="function">(<span class="params">res</span>)=&gt;</span> &#123;</span><br><span class="line">    res.tempFilePath <span class="comment">// 文件路径</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>出现本机和服务器地址不一致，一般在 H5端出现跨域问题。此时需要后端去开启一些配置。</p>
<h4 id="2）保存图片到本地-uni-saveImageToPhotosAlbum"><a href="#2）保存图片到本地-uni-saveImageToPhotosAlbum" class="headerlink" title="2）保存图片到本地 uni.saveImageToPhotosAlbum"></a>2）保存图片到本地 uni.saveImageToPhotosAlbum</h4><p>接着上面的代码的 success 回调写，假设我们这里是图片资源。</p>
<blockquote>
<p>H5 和 支付宝小程序是不支持的。微信小程序需要打开调试模式</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">filePath  可以是临时路径</span><br><span class="line"></span><br><span class="line">uni.saveImageToPhotosAlbum(&#123;</span><br><span class="line">  filePath:url,</span><br><span class="line">  success:<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">    uni.showToast(&#123;</span><br><span class="line">      title:<span class="string">'保存成功'</span>,</span><br><span class="line">      duration:<span class="number">2000</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  complate:<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">    uni.hideLoading()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="5-第三方登录-uni-login"><a href="#5-第三方登录-uni-login" class="headerlink" title="5 第三方登录 uni.login"></a>5 第三方登录 uni.login</h3><blockquote>
<p>H5 不支持，要使用条件编译排除</p>
</blockquote>
<h4 id="1）微信小程序登录"><a href="#1）微信小程序登录" class="headerlink" title="1）微信小程序登录"></a>1）微信小程序登录</h4><ul>
<li>基本页面构建</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1 第三方登录H5不支持，所以隐藏掉 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- #ifndef H5 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"third-wapper"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 与上面表单的分割线 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"third-line"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"single-line"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"line"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"third-words"</span>&gt;</span>第三方账号登录<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"single-line"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"line"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 2 5+app 用qq/微信/微博 登录 小程序用微信小程序登录(data-logintype) h5不支持 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"third-icos-wapper"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 嵌入各平台图片，点击后触发 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- #ifdef APP-PLUS --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">"../../static/icos/weixin.png"</span> <span class="attr">data-logintype</span>=<span class="string">"weixin"</span> @<span class="attr">click</span>=<span class="string">"appOAuthLogin"</span> <span class="attr">class</span>=<span class="string">"third-ico"</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">"../../static/icos/QQ.png"</span> <span class="attr">data-logintype</span>=<span class="string">"qq"</span> @<span class="attr">click</span>=<span class="string">"appOAuthLogin"</span> <span class="attr">class</span>=<span class="string">"third-ico"</span> <span class="attr">style</span>=<span class="string">"margin-left: 80upx;"</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">"../../static/icos/weibo.png"</span> <span class="attr">data-logintype</span>=<span class="string">"sinaweibo"</span> @<span class="attr">click</span>=<span class="string">"appOAuthLogin"</span> <span class="attr">class</span>=<span class="string">"third-ico"</span> <span class="attr">style</span>=<span class="string">"margin-left: 80upx;"</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- #endif --&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 3 微信开放能力，获取用户信息的按钮 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- #ifdef MP-WEIXIN --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">open-type</span>=<span class="string">'getUserInfo'</span> @<span class="attr">getuserinfo</span>=<span class="string">"wxLogin"</span> <span class="attr">class</span>=<span class="string">"third-btn-ico"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- #endif --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- #endif --&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>css样式</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 1 第三方登录 start */</span></span><br><span class="line"><span class="selector-class">.third-wapper</span> &#123;</span><br><span class="line">	<span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">	<span class="attribute">margin-top</span>: <span class="number">60</span>upx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 2 分割线容器 */</span></span><br><span class="line"><span class="selector-class">.third-line</span> &#123;</span><br><span class="line">	<span class="attribute">display</span>: flex;</span><br><span class="line">	<span class="attribute">flex-direction</span>: row;</span><br><span class="line">	<span class="attribute">justify-content</span>: center</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 3 分割线文字 */</span></span><br><span class="line"><span class="selector-class">.third-words</span> &#123;</span><br><span class="line">	<span class="attribute">color</span>: <span class="number">#A9A9A9</span>;</span><br><span class="line">	<span class="attribute">font-size</span>: <span class="number">13px</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="attribute">display</span>: flex;</span><br><span class="line">	<span class="attribute">flex-direction</span>: column;</span><br><span class="line">	<span class="attribute">justify-content</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 4 线条 */</span></span><br><span class="line"><span class="selector-class">.single-line</span> &#123;</span><br><span class="line">	<span class="attribute">padding</span>: <span class="number">15</span>upx <span class="number">20</span>upx;</span><br><span class="line">	<span class="attribute">width</span>: <span class="number">25%</span>;</span><br><span class="line">	<span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 5 各平台图标容器布局 */</span></span><br><span class="line"><span class="selector-class">.third-icos-wapper</span> &#123;</span><br><span class="line">	<span class="attribute">margin-top</span>: <span class="number">30</span>upx;</span><br><span class="line">	</span><br><span class="line">	<span class="attribute">display</span>: flex;</span><br><span class="line">	<span class="attribute">flex-direction</span>: row;</span><br><span class="line">	<span class="attribute">justify-content</span>: center</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 6 图标大小 */</span></span><br><span class="line"><span class="selector-class">.third-ico</span> &#123;</span><br><span class="line">	<span class="attribute">width</span>: <span class="number">60</span>upx;</span><br><span class="line">	<span class="attribute">height</span>: <span class="number">60</span>upx;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>实现微信小程序端的微信登录</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 微信提供的获取用户基本信息的按钮，open-type='getUserInfo' @getuserinfo="wxLogin"</span></span><br><span class="line">wxLogin(e)&#123;</span><br><span class="line">  <span class="keyword">var</span> me = <span class="keyword">this</span>;</span><br><span class="line">  <span class="comment">// 1 通过微信开发能力，获得微信用户的基本信息</span></span><br><span class="line">  <span class="keyword">var</span> userInfo = e.detail.userInfo;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2 实现微信登录</span></span><br><span class="line">  uni.login(&#123;</span><br><span class="line">    provider: <span class="string">"weixin"</span>,</span><br><span class="line">    success(loginResult) &#123;</span><br><span class="line">      <span class="comment">// 3 获得微信登录的code：登录授权码</span></span><br><span class="line">      <span class="keyword">var</span> code = loginResult.code;</span><br><span class="line">      <span class="comment">// 4 设置登录到哪个对于的微信小程序，大家可以根据自己的后端去实现业务参数</span></span><br><span class="line">      <span class="comment">// [0:NEXT超英预告][1:超英预告][2:NEXT学院电影预告]</span></span><br><span class="line">      <span class="keyword">var</span> loginToWhichMP = <span class="number">1</span>;</span><br><span class="line">      <span class="comment">// 5 发起请求</span></span><br><span class="line">      uni.request(&#123;</span><br><span class="line">        url: me.serverUrl + <span class="string">"/mpWXLogin/"</span> + code,</span><br><span class="line">        data: &#123;</span><br><span class="line">          <span class="string">"avatarUrl"</span>: userInfo.avatarUrl,</span><br><span class="line">          <span class="string">"nickName"</span>: userInfo.nickName,</span><br><span class="line">          <span class="string">"whichMP"</span>: loginToWhichMP</span><br><span class="line">        &#125;,</span><br><span class="line">        method: <span class="string">"POST"</span>,</span><br><span class="line">        success(userResult) &#123;</span><br><span class="line">          <span class="keyword">var</span> userInfo = userResult.data.data;</span><br><span class="line">          <span class="comment">// 6 保存用户信息到全局的缓存中</span></span><br><span class="line">          uni.setStorageSync(<span class="string">"globalUser"</span>, userInfo);</span><br><span class="line">          <span class="comment">// 7 切换页面跳转，使用tab切换的api</span></span><br><span class="line">          uni.switchTab(&#123;</span><br><span class="line">            url: <span class="string">"../me/me"</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>后端处理登录（java）</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1 根据微信登录的处理流程，要携带4个参数去访问微信提供的请求</span></span><br><span class="line"><span class="comment">// https://api.weixin.qq.com/sns/jscode2session?appid=APPID&amp;secret=SECRET&amp;js_code=JSCODE&amp;grant_type=authorization_code</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2 这些敏感数据都是放在后端的</span></span><br><span class="line">String appid = xxxx;</span><br><span class="line">String secret = xxxx;</span><br><span class="line">String url = <span class="string">"https://api.weixin.qq.com/sns/jscode2session"</span>;</span><br><span class="line">Map&lt;String, String&gt; param = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">param.put(<span class="string">'addid'</span>, appid);</span><br><span class="line">param.put(<span class="string">'secret'</span>, secret);</span><br><span class="line">param.put(<span class="string">'js_code'</span>, code); <span class="comment">// code 是前端执行 wx.login 得到的登录凭证</span></span><br><span class="line">param.put(<span class="string">'grant_type'</span>, <span class="string">"authorization_code"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3 发起请求</span></span><br><span class="line"><span class="comment">// 得到的字符串，要自己转换。session_key, openid(用户唯一Id)</span></span><br><span class="line">String wxResult = HttpClientUtil.doGet(url, param); </span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment">// 4 用户查询...处理用户信息...</span></span><br></pre></td></tr></table></figure>

<h4 id="2）APP-登录"><a href="#2）APP-登录" class="headerlink" title="2）APP 登录"></a>2）APP 登录</h4><ul>
<li>实现 APP 授权登录，总体和 APP 差不多</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">appOAuthLogin(e) &#123;</span><br><span class="line">  <span class="keyword">var</span> me = <span class="keyword">this</span>;</span><br><span class="line">  <span class="comment">// 1 获取用户的登录类型</span></span><br><span class="line">  <span class="keyword">var</span> logintype = e.currentTarget.dataset.logintype;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2 授权登录</span></span><br><span class="line">  uni.login(&#123;</span><br><span class="line">    provider: logintype,</span><br><span class="line">    success(loginRes) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 3 授权登录成功以后，获取用户的信息</span></span><br><span class="line">      uni.getUserInfo(&#123;</span><br><span class="line">        provider: logintype, <span class="comment">// 服务商类型</span></span><br><span class="line">        success(info) &#123;</span><br><span class="line">          <span class="comment">// 4 根据不同平台获取信息的方式不同，去获取有差异的信息字段</span></span><br><span class="line">          <span class="keyword">var</span> userInfo = info.userInfo;</span><br><span class="line">          <span class="keyword">var</span> face = <span class="string">""</span>;</span><br><span class="line">          <span class="keyword">var</span> nickname = <span class="string">""</span>;</span><br><span class="line">          <span class="keyword">var</span> openIdOrUid = <span class="string">""</span>;</span><br><span class="line">          <span class="keyword">if</span> (logintype == <span class="string">"weixin"</span>) &#123;</span><br><span class="line">						<span class="comment">// ...</span></span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (logintype == <span class="string">"qq"</span>) &#123;</span><br><span class="line">						<span class="comment">// ...</span></span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (logintype == <span class="string">"sinaweibo"</span>) &#123;</span><br><span class="line">           <span class="comment">// ...</span></span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="comment">// 5 调用开发者后台，执行一键注册或登录</span></span><br><span class="line">          uni.request(&#123;</span><br><span class="line">            url: me.serverUrl + <span class="string">"/appUnionLogin/"</span> + logintype,</span><br><span class="line">            data: &#123;</span><br><span class="line">              <span class="string">"openIdOrUid"</span>: openIdOrUid,</span><br><span class="line">              <span class="string">"nickname"</span>: nickname,</span><br><span class="line">              <span class="string">"face"</span>: face</span><br><span class="line">            &#125;,</span><br><span class="line">            method: <span class="string">"POST"</span>,</span><br><span class="line">            success(result) &#123;</span><br><span class="line">              <span class="keyword">if</span> (result.data.status == <span class="number">200</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> userInfo = result.data.data;</span><br><span class="line">                <span class="comment">// 6 保存用户信息到全局的缓存中</span></span><br><span class="line">                uni.setStorageSync(<span class="string">"globalUser"</span>, userInfo);</span><br><span class="line">                <span class="comment">// 7 切换页面跳转，使用tab切换的api</span></span><br><span class="line">                uni.switchTab(&#123;</span><br><span class="line">                  url: <span class="string">"../me/me"</span></span><br><span class="line">                &#125;);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="6-插件使用"><a href="#6-插件使用" class="headerlink" title="6 插件使用"></a>6 插件使用</h3><blockquote>
<p>在 HBuilderX 中可以创建模块项目，里面有官方所有的插件组价的代码。</p>
<p>也可以去插件市场下载</p>
</blockquote>
<h4 id="1）图片剪裁"><a href="#1）图片剪裁" class="headerlink" title="1）图片剪裁"></a>1）图片剪裁</h4><p>可以去下载 APP， <code>hello uni-app</code>，里面可以看到现有官方原生组件</p>
<p>如果是从 HBX 里创建的模板项目，则可以去 <code>pages/tempalte/crop</code>里看（版本更新下可能目录有变化）</p>
<h1 id="五、业务处理"><a href="#五、业务处理" class="headerlink" title="五、业务处理"></a>五、业务处理</h1><h2 id="（一）全局变量和状态"><a href="#（一）全局变量和状态" class="headerlink" title="（一）全局变量和状态"></a>（一）全局变量和状态</h2><h3 id="1-全局变量-公共组件"><a href="#1-全局变量-公共组件" class="headerlink" title="1 全局变量 - 公共组件"></a>1 全局变量 - 公共组件</h3><h4 id="1）创建-common-目录"><a href="#1）创建-common-目录" class="headerlink" title="1）创建 common 目录"></a>1）创建 common 目录</h4><p><code>common/common.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1 应用场景：全局请求基地址</span></span><br><span class="line"><span class="keyword">const</span> serverUrl = <span class="string">"https://xxx"</span> <span class="comment">// 生产环境</span></span><br><span class="line"><span class="comment">// const serverUrl = "https://xxx2" // 开发环境</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  serverUrl</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2）导入-common-并使用"><a href="#2）导入-common-并使用" class="headerlink" title="2）导入 common 并使用"></a>2）导入 common 并使用</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> common <span class="keyword">from</span> <span class="string">'../../common/commin.js'</span></span><br><span class="line"></span><br><span class="line">onLoad:<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">const</span> serverUrl = common.serverUrl</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-全局变量-Vue-prototype"><a href="#2-全局变量-Vue-prototype" class="headerlink" title="2 全局变量 - Vue.prototype"></a>2 全局变量 - Vue.prototype</h3><blockquote>
<p>挂载到 Vue 实例中</p>
</blockquote>
<h4 id="1）main-js-扩展-Vue-实例"><a href="#1）main-js-扩展-Vue-实例" class="headerlink" title="1）main.js 扩展 Vue 实例"></a>1）main.js 扩展 Vue 实例</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Vue.prototype.serverUrl = <span class="string">"xxxx"</span> <span class="comment">// 开发/生产环境</span></span><br></pre></td></tr></table></figure>

<h4 id="2）从实例中拿"><a href="#2）从实例中拿" class="headerlink" title="2）从实例中拿"></a>2）从实例中拿</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">onLoad:<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">	<span class="keyword">const</span> url = <span class="keyword">this</span>.serverUrl</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="（二）数据处理"><a href="#（二）数据处理" class="headerlink" title="（二）数据处理"></a>（二）数据处理</h2><h3 id="1-data-自定义属性"><a href="#1-data-自定义属性" class="headerlink" title="1 :data-* 自定义属性"></a>1 :data-* 自定义属性</h3><p>场景，点击某个列表项获取该项的标识值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;view v-for=&quot;(item, idx) in Lists&quot;&gt;</span><br><span class="line">  	&lt;view :data-list=&quot;idx&quot; @click=&quot;fn&quot;&gt;&lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">	  export default &#123;</span><br><span class="line">      data()&#123;</span><br><span class="line">        return &#123;</span><br><span class="line">          lists:[]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      methods:&#123;</span><br><span class="line">        fn(e)&#123;</span><br><span class="line">          // 获取</span><br><span class="line">          this.id = e.currentTarger.dataset.idx</span><br><span class="line">          this.lists[id] = xxxx</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="2-分页处理"><a href="#2-分页处理" class="headerlink" title="2 分页处理"></a>2 分页处理</h3><h4 id="1）通用参数"><a href="#1）通用参数" class="headerlink" title="1）通用参数"></a>1）通用参数</h4><p>一般在分页实现的逻辑中，必定会使用到几个参数和概念</p>
<ul>
<li><p>key， 搜索内容或关键词</p>
</li>
<li><p>page，查询的页面的页数</p>
</li>
<li><p>pageSize，每页显示的条数</p>
</li>
<li><p>total，总页数</p>
</li>
<li><p>records，总记录数</p>
</li>
</ul>
<p>其他需要配合的处理</p>
<ul>
<li>loading</li>
<li>触底响应分页</li>
<li>input 绑定输入事件</li>
</ul>
<h4 id="2）请求和分页逻辑"><a href="#2）请求和分页逻辑" class="headerlink" title="2）请求和分页逻辑"></a>2）请求和分页逻辑</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1 在 data 部分，需要预留几个必要的变量</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  data()&#123;</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">      dataList:[],</span><br><span class="line">      keywords:<span class="string">''</span>, <span class="comment">//  搜索关键字</span></span><br><span class="line">      page:<span class="number">1</span>, <span class="comment">// 当前页数</span></span><br><span class="line">      totalPages:<span class="number">1</span> <span class="comment">// 总页数</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods:&#123;</span><br><span class="line">    <span class="comment">// 2 分页方法</span></span><br><span class="line">    pagedTrailerList(key, page, pageSize)&#123;</span><br><span class="line">      <span class="keyword">const</span> that = <span class="keyword">this</span></span><br><span class="line">      <span class="comment">// loading</span></span><br><span class="line">      uni.showLoading(&#123;</span><br><span class="line">        mask:<span class="literal">true</span>,</span><br><span class="line">        title:<span class="string">'请稍后...'</span></span><br><span class="line">      &#125;)</span><br><span class="line">      uni.showNavigationBarLoading()</span><br><span class="line">      <span class="comment">// 执行请求，拼接查询参数</span></span><br><span class="line">      uni.request(&#123;</span><br><span class="line">        url:<span class="string">`xxx?keywords=<span class="subst">$&#123;key&#125;</span>&amp;page=<span class="subst">$&#123;page&#125;</span>&amp;pageSize=<span class="subst">$&#123;pageSize&#125;</span>`</span>,</span><br><span class="line">        method:<span class="string">'POST'</span>,</span><br><span class="line">        success:<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// 验证请求状态</span></span><br><span class="line">          <span class="keyword">if</span>(res.data.status === <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="comment">// 更新 data 绑定变量</span></span><br><span class="line">            <span class="keyword">var</span> tempList = res.data.data.rows</span><br><span class="line">            that.dataList = [...that.dataList, ...tempList] <span class="comment">// 拼接数组</span></span><br><span class="line">            that.totalPages = res.data.data.total <span class="comment">// 总页数</span></span><br><span class="line">            that.page = page <span class="comment">// 当前页数</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        complete:<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// 关闭 loading</span></span><br><span class="line">          uni.hideNavigationBarLoading()</span><br><span class="line">          uni.hideLoading()</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 3 搜索方法</span></span><br><span class="line">    search(e) &#123;</span><br><span class="line">      <span class="keyword">const</span> that = <span class="keyword">this</span></span><br><span class="line">      <span class="keyword">let</span> value = e.detail.value</span><br><span class="line">      <span class="comment">// 假设通过分页组件，拿到了 page, pageSize 分别为 1， 15(web 端)</span></span><br><span class="line">      <span class="comment">// 手机端一般是通过触底分页</span></span><br><span class="line">      that.keywords = value</span><br><span class="line">      that.dataList = []</span><br><span class="line">      that.pagedTrailerList(value, <span class="number">1</span>, <span class="number">15</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 4 触底分页响应</span></span><br><span class="line">  onReachBottom()&#123;</span><br><span class="line">    <span class="keyword">const</span> that = <span class="keyword">this</span></span><br><span class="line">    <span class="keyword">let</span> page = that.page + <span class="number">1</span> <span class="comment">// 查询下一页</span></span><br><span class="line">    <span class="keyword">let</span> keywords = that.totalPages <span class="comment">// 搜索值</span></span><br><span class="line">    <span class="keyword">let</span> totalPages = that.totalPages <span class="comment">// 总页数</span></span><br><span class="line">     <span class="comment">// 若需要分页的分页数与总页数相等，说明没有更多数据，就不分页</span></span><br><span class="line">    page &gt; totalPages &amp;&amp; <span class="keyword">return</span></span><br><span class="line">    <span class="comment">// 执行分页方法</span></span><br><span class="line">    that.pagedTrailerList(keywords, page, totalPages)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-data-复杂数据加载"><a href="#3-data-复杂数据加载" class="headerlink" title="3 data 复杂数据加载"></a>3 data 复杂数据加载</h3><p>在 HTML 部分如果绑定了 obj.xxx， 在 data 定义改对象变量时，没有定义这个 xxx 属性。那么在 created 生命周期的时候可能就拿不到这个 xxx 的值。</p>
<blockquote>
<p>这是因为只有在 data 属性中定义的变量才是响应式的</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">block</span> <span class="attr">v-if</span>=<span class="string">"obj.xxx"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">view</span>&gt;</span>&#123;&#123;obj.xxx&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="（三）页面控制"><a href="#（三）页面控制" class="headerlink" title="（三）页面控制"></a>（三）页面控制</h2><h3 id="1-动画创建-uni-createAnimation"><a href="#1-动画创建-uni-createAnimation" class="headerlink" title="1 动画创建 - uni.createAnimation"></a>1 动画创建 - uni.createAnimation</h3><blockquote>
<p>不支持 H5，所以要条件编译。</p>
</blockquote>
<h4 id="1）创建动画数据对象"><a href="#1）创建动画数据对象" class="headerlink" title="1）创建动画数据对象"></a>1）创建动画数据对象</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  data()&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="comment">// 1 动画配置属性</span></span><br><span class="line">      animationData:&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  onLoad:<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// 2 页面加载 - 创建临时动画对象</span></span><br><span class="line">    <span class="keyword">this</span>.animation = uni.createAnimation()</span><br><span class="line">  &#125;,</span><br><span class="line">  onUnload:<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// 3 页面卸载 - 清除动画数据</span></span><br><span class="line">    <span class="keyword">this</span>.animationData = &#123;&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods:&#123;</span><br><span class="line">    <span class="comment">// 4 实现动画效果</span></span><br><span class="line">    praiseMe()&#123;</span><br><span class="line">      <span class="comment">// Y轴偏移, 显示， step 表示该组动画结束</span></span><br><span class="line">      <span class="keyword">this</span>.animation.translateY(<span class="number">-60</span>).opacity(<span class="number">1</span>).step(&#123;</span><br><span class="line">        duration:<span class="number">400</span></span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 5 导出临时动画数据给实例属性变量，实现动画的效果</span></span><br><span class="line">      <span class="keyword">this</span>.animationData = <span class="keyword">this</span>.animation.export()</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 6 延迟还原动画</span></span><br><span class="line">      setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.animation.translateY(<span class="number">0</span>).opacity(<span class="number">0</span>).step(&#123;</span><br><span class="line">          duration:<span class="number">0</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">this</span>.animationData = <span class="keyword">this</span>.animation.export()</span><br><span class="line">      &#125;.bind(<span class="keyword">this</span>), <span class="number">500</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2）挂载到组件元素属性上"><a href="#2）挂载到组件元素属性上" class="headerlink" title="2）挂载到组件元素属性上"></a>2）挂载到组件元素属性上</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">:animation</span>=<span class="string">"animationData"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="3）样式设置"><a href="#3）样式设置" class="headerlink" title="3）样式设置"></a>3）样式设置</h4><p>对于要进行动画的组件，<code>opacity</code>一开始最好设置为0</p>
<h3 id="2-类似搜索框的样式实现"><a href="#2-类似搜索框的样式实现" class="headerlink" title="2 类似搜索框的样式实现"></a>2 类似搜索框的样式实现</h3><ul>
<li>用 flex 中心对齐图标和input</li>
<li>更改容器背景色与 input 一致<ul>
<li>视觉上像是 input 延长并包裹了图标</li>
</ul>
</li>
<li>给 input 增加 z-index 以不被其他内容遮挡</li>
<li>给内容区增加 margin-top 以不被 Input 遮挡</li>
</ul>
<h2 id="（四）用户页面"><a href="#（四）用户页面" class="headerlink" title="（四）用户页面"></a>（四）用户页面</h2><h3 id="1-登录显示"><a href="#1-登录显示" class="headerlink" title="1 登录显示"></a>1 登录显示</h3><p>通过登录状态来判断用户是否登录，用 <code>v-if</code> 来区别展示未登录时默认的用户占位信息（如默认图片，提示登录按钮，其实是用 <navigation> 组件包裹）。</navigation></p>
<h3 id="2-用户登录页面"><a href="#2-用户登录页面" class="headerlink" title="2 用户登录页面"></a>2 用户登录页面</h3><p>一般会有图片，然后是账号密码输入框（带Icon）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;form @submit=&quot;formSubmit&quot;&gt;</span><br><span class="line">  &lt;view class=&quot;body&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;face-wapper&quot;&gt;</span><br><span class="line">      &lt;image src=&quot;&quot; class=&quot;face&quot;&gt;&lt;/image&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">    &lt;view class=&quot;info-wapper&quot;&gt;</span><br><span class="line">      &lt;label class=&quot;words-lbl&quot;&gt;账户&lt;/label&gt;</span><br><span class="line">      &lt;input name=&quot;username&quot; type=&quot;text&quot; value=&quot;&quot; class=&quot;input&quot; placeholder=&quot;请输入用户名&quot; placeholder-class=&quot;graywords&quot;/&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">    &lt;view class=&quot;info-wapper&quot; style=&quot;margin-top:40rpx;&quot;&gt;</span><br><span class="line">      &lt;label class=&quot;words-lbl&quot;&gt;密码&lt;/label&gt;</span><br><span class="line">      &lt;input name=&quot;password&quot; type=&quot;text&quot; password=&quot;true&quot; value=&quot;&quot; class=&quot;input&quot; placeholder=&quot;请输入密码&quot; placeholder-class=&quot;graywords&quot;/&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">    &lt;button type=&quot;primary&quot; style=&quot;margin-top:60rpx; width:90%&quot;  form-type=&quot;submit&quot;&gt;注册/登录&lt;/button&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">  &lt;/form&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    methods:&#123;</span><br><span class="line">      // 拿到表单值</span><br><span class="line">      formSubmit(e)&#123;</span><br><span class="line">        const that = this</span><br><span class="line">        // &#123;&#125; 包含了在各个表单组件中 name 属性对应的表单值</span><br><span class="line">        const obj = e.detail.value </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">  .body&#123;</span><br><span class="line">    border-top:solid 1px #DBDBDA;</span><br><span class="line">    padding:0 40rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  .facr-wapper &#123;	</span><br><span class="line">    display:flex;</span><br><span class="line">    flex-direction:row;</span><br><span class="line">    justify-content:center;</span><br><span class="line"></span><br><span class="line">    margin-top:120rpx;</span><br><span class="line">    margin-bottom:120rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  .info-wapper&#123;</span><br><span class="line">    display:flex;</span><br><span class="line">    flex-direction:row;</span><br><span class="line">    justify-content:center;	</span><br><span class="line"></span><br><span class="line">    border-buttom:solid 1px #DBDBDA;</span><br><span class="line"></span><br><span class="line">    padding-bottom:20rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  .face &#123;</span><br><span class="line">    width:160rpx;</span><br><span class="line">    height:160rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  .input &#123;</span><br><span class="line">    width:500rpx;</span><br><span class="line">    margin-left:40rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  .words-lbl&#123;</span><br><span class="line">    color:#808080;</span><br><span class="line">  &#125;</span><br><span class="line">  .graywords &#123;</span><br><span class="line">    color:#EAEAEA    </span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="3-发起登录请求-uni-request"><a href="#3-发起登录请求-uni-request" class="headerlink" title="3 发起登录请求 uni.request"></a>3 发起登录请求 uni.request</h3><p>接上上面的 <code>formSubmit</code> 方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ... 发起用户登录请求，发送账号密码</span></span><br><span class="line"><span class="keyword">const</span> serverUrl = that.serverUrl</span><br><span class="line">uni.request(&#123;</span><br><span class="line">  url:serverUrl + xxx,</span><br><span class="line">  data:&#123;</span><br><span class="line">    username,</span><br><span class="line">    password</span><br><span class="line">  &#125;</span><br><span class="line">  method:<span class="string">'POST'</span>,</span><br><span class="line">  success:<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// 检查响应状态</span></span><br><span class="line">  	<span class="keyword">if</span> (res.data.status === <span class="number">200</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> userInfo = res.data.data</span><br><span class="line">      <span class="comment">// ... 缓存</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="4-用户信息缓存-uni-setStorageSync-和登录失败"><a href="#4-用户信息缓存-uni-setStorageSync-和登录失败" class="headerlink" title="4 用户信息缓存 uni.setStorageSync 和登录失败"></a>4 用户信息缓存 uni.setStorageSync 和登录失败</h3><p>获得的用户信息需要缓存，在该登录状态周期内一直可以重复使用。</p>
<p>API 的话一般都是使用同步，异步会有一定问题，用在特殊场景。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">success:<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (res.data.status === <span class="number">200</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> userInfo = res.data.data</span><br><span class="line">    <span class="comment">// 缓存用户信息</span></span><br><span class="line">    uni.setStorageSync(<span class="string">'globalUser'</span>, userInfo)</span><br><span class="line">    <span class="comment">// 切换跳转到用户个人页面</span></span><br><span class="line">    uni.swichTab(&#123;</span><br><span class="line">      url:<span class="string">'../me/me'</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(res.data.status === <span class="number">500</span>) &#123;</span><br><span class="line">    uni.showToast(&#123;</span><br><span class="line">      title:res.data.msg,</span><br><span class="line">      duration:<span class="number">2000</span>,</span><br><span class="line">      image:<span class="string">'../../static/icons/xxx.png'</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-拿到缓存中的用户信息-uni-getStorageSync"><a href="#5-拿到缓存中的用户信息-uni-getStorageSync" class="headerlink" title="5 拿到缓存中的用户信息 uni.getStorageSync"></a>5 拿到缓存中的用户信息 uni.getStorageSync</h3><p>页面加载后，从缓存中取出个人信息</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  data()&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      userIsLogin: <span class="literal">false</span>, <span class="comment">// 用户登录状态</span></span><br><span class="line">      userInfo:&#123;&#125; <span class="comment">// 用户对象</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  onShow()&#123;</span><br><span class="line">   <span class="keyword">const</span> that = <span class="keyword">this</span></span><br><span class="line">   <span class="keyword">const</span> userInfo = uni.getStorageSync(<span class="string">'globalUser'</span>)</span><br><span class="line">   <span class="comment">// 登录态判空后再获取用户数据</span></span><br><span class="line">   <span class="keyword">if</span> (userInfo != <span class="literal">null</span> &amp;&amp; userInfo != <span class="string">''</span> &amp;&amp; userInfo != <span class="literal">undefined</span>)&#123;</span><br><span class="line">     that.userIsLogin = <span class="literal">true</span></span><br><span class="line">     that.userInfo = userInfo</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">     that.userIsLogin = <span class="literal">false</span></span><br><span class="line">     that.userInfo = &#123;&#125;</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面的判空方法，明显就是可以提取为全局方法。一样去扩展 Vue</p>
<p>那么可以完全取代上面的写法， <code>this.getGlobalUser(&#39;globalUser&#39;)</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line">Vue.prototype.getGlobalUser = <span class="function"><span class="keyword">function</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 缓存中取</span></span><br><span class="line">  <span class="keyword">const</span> userInfo = uni.getStorageSync(key)</span><br><span class="line">  <span class="keyword">if</span> (userInfo != <span class="literal">null</span> &amp;&amp; userInfo != <span class="string">''</span> &amp;&amp; userInfo != <span class="literal">undefined</span>)&#123;</span><br><span class="line">    	<span class="keyword">return</span> userInfo</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">     	<span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-用户个人信息详情页"><a href="#6-用户个人信息详情页" class="headerlink" title="6 用户个人信息详情页"></a>6 用户个人信息详情页</h3><h4 id="1）页面骨架"><a href="#1）页面骨架" class="headerlink" title="1）页面骨架"></a>1）页面骨架</h4><p>包括，头像、昵称（其他都是类似的）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 页面容器 --&gt;</span><br><span class="line">	&lt;view class=&quot;page page-fill&quot;&gt;</span><br><span class="line">		&lt;view class=&quot;page-block info-list&quot;&gt;</span><br><span class="line">			&lt;!-- 1 头像 --&gt;</span><br><span class="line">			&lt;view class=&quot;item-wapper face-line-upbottom&quot; @click=&quot;operator&quot;&gt;</span><br><span class="line">				&lt;view class=&quot;info-words&quot;&gt;头像&lt;/view&gt;</span><br><span class="line">				&lt;view class=&quot;right-wapper&quot;&gt;</span><br><span class="line">					&lt;image :src=&quot;globalUser.faceImage&quot; class=&quot;face&quot;&gt;&lt;/image&gt;</span><br><span class="line">					&lt;view class=&quot;arrow-block&quot;&gt;</span><br><span class="line">						&lt;image src=&quot;../../static/icos/left-gray-arrow.png&quot; class=&quot;arrow-ico&quot;&gt;&lt;/image&gt;</span><br><span class="line">					&lt;/view&gt;</span><br><span class="line">				&lt;/view&gt;</span><br><span class="line">			&lt;/view&gt;</span><br><span class="line">			&lt;!-- 分割线 --&gt;</span><br><span class="line">			&lt;view class=&quot;line-top&quot;&gt;</span><br><span class="line">				&lt;view class=&quot;line&quot;&gt;&lt;/view&gt;</span><br><span class="line">			&lt;/view&gt;</span><br><span class="line">			</span><br><span class="line">			&lt;!-- 2 昵称 --&gt;</span><br><span class="line">			&lt;view class=&quot;item-wapper&quot; @click=&quot;modifyNickname&quot;&gt;</span><br><span class="line">				&lt;view class=&quot;info-words&quot;&gt;昵称&lt;/view&gt;</span><br><span class="line">				&lt;view class=&quot;right-wapper&quot;&gt;</span><br><span class="line">					&lt;view class=&quot;gray-fields&quot;&gt;</span><br><span class="line">						&#123;&#123;globalUser.nickname&#125;&#125;</span><br><span class="line">					&lt;/view&gt;</span><br><span class="line">					&lt;view class=&quot;arrow-block&quot;&gt;</span><br><span class="line">						&lt;image src=&quot;../../static/icos/left-gray-arrow.png&quot; class=&quot;arrow-ico&quot;&gt;&lt;/image&gt;</span><br><span class="line">					&lt;/view&gt;</span><br><span class="line">				&lt;/view&gt;</span><br><span class="line">			&lt;/view&gt;</span><br><span class="line">			</span><br><span class="line">			&lt;view class=&quot;line-top&quot;&gt;</span><br><span class="line">				&lt;view class=&quot;line&quot;&gt;&lt;/view&gt;</span><br><span class="line">			&lt;/view&gt;</span><br><span class="line">		&lt;/view&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;view class=&quot;footer-wapper&quot;&gt;</span><br><span class="line">			&lt;view class=&quot;footer-words&quot; @click=&quot;cleanStorage&quot;&gt;</span><br><span class="line">				清理缓存</span><br><span class="line">			&lt;/view&gt;</span><br><span class="line">			&lt;view class=&quot;footer-words&quot; style=&quot;margin-top: 10upx;&quot; @click=&quot;logout&quot;&gt;</span><br><span class="line">				退出登录</span><br><span class="line">			&lt;/view&gt;</span><br><span class="line">		&lt;/view&gt;</span><br><span class="line">	&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h4 id="2）CSS-样式控制"><a href="#2）CSS-样式控制" class="headerlink" title="2）CSS 样式控制"></a>2）CSS 样式控制</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 页面铺满屏幕 */</span></span><br><span class="line"><span class="comment">/* 1 保证页面背景色 */</span></span><br><span class="line"><span class="selector-class">.page-fill</span> &#123;</span><br><span class="line">	<span class="attribute">width</span>:<span class="number">100%</span>;</span><br><span class="line">	<span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">	<span class="attribute">position</span>: absolute;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 2 页面内边距 */</span></span><br><span class="line"><span class="selector-class">.info-list</span> &#123;</span><br><span class="line">	<span class="comment">/* margin-top: 20upx; */</span></span><br><span class="line">	<span class="attribute">padding</span>: <span class="number">0</span>upx <span class="number">30</span>upx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 3 信息容器的定位布局 */</span></span><br><span class="line"><span class="selector-class">.item-wapper</span> &#123;</span><br><span class="line">	<span class="attribute">display</span>: flex;</span><br><span class="line">	<span class="attribute">flex-direction</span>: row;</span><br><span class="line">	<span class="attribute">justify-content</span>: flex-start;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.face-line-upbottom</span> &#123;</span><br><span class="line">	<span class="attribute">margin-top</span>: <span class="number">20</span>upx;</span><br><span class="line">	<span class="attribute">padding-top</span>: <span class="number">20</span>upx;</span><br><span class="line">	<span class="attribute">padding-bottom</span>: <span class="number">20</span>upx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 4 文字的设置 */</span></span><br><span class="line"><span class="selector-class">.info-words</span> &#123;</span><br><span class="line">	<span class="attribute">color</span>: <span class="number">#333333</span>;</span><br><span class="line">	<span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">	<span class="attribute">width</span>: <span class="number">25%</span>;</span><br><span class="line">	<span class="attribute">line-height</span>: <span class="number">80</span>upx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.gray-fields</span> &#123;</span><br><span class="line">	<span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">	<span class="attribute">color</span>: darkgray;</span><br><span class="line">	<span class="attribute">line-height</span>: <span class="number">80</span>upx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 5 flex 右侧布局 */</span></span><br><span class="line"><span class="selector-class">.right-wapper</span> &#123;</span><br><span class="line">	<span class="attribute">width</span>: <span class="number">80%</span>;</span><br><span class="line">	<span class="attribute">display</span>: flex;</span><br><span class="line">	<span class="attribute">flex-direction</span>: row;</span><br><span class="line">	<span class="attribute">justify-content</span>: flex-end;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 6 图片的设置 */</span></span><br><span class="line"><span class="selector-class">.face</span> &#123;</span><br><span class="line">	<span class="attribute">width</span>: <span class="number">80</span>upx;</span><br><span class="line">	<span class="attribute">height</span>: <span class="number">80</span>upx;</span><br><span class="line">	<span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 7 点击箭头的定位 */</span></span><br><span class="line"><span class="selector-class">.arrow-block</span> &#123;</span><br><span class="line">	<span class="attribute">margin-left</span>: <span class="number">10</span>upx;</span><br><span class="line">	<span class="attribute">line-height</span>: <span class="number">86</span>upx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 8 箭头本身大小 */</span></span><br><span class="line"><span class="selector-class">.arrow-ico</span> &#123;</span><br><span class="line">	<span class="attribute">width</span>: <span class="number">30</span>upx;</span><br><span class="line">	<span class="attribute">height</span>: <span class="number">30</span>upx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 9 分割线 */</span></span><br><span class="line"><span class="selector-class">.line-top</span> &#123;</span><br><span class="line">	<span class="attribute">margin-top</span>: <span class="number">20</span>upx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 10 底部按钮操作 start */</span></span><br><span class="line"><span class="selector-class">.footer-wapper</span> &#123;</span><br><span class="line">	<span class="attribute">position</span>: fixed;</span><br><span class="line">	<span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="attribute">display</span>: flex;</span><br><span class="line">	<span class="attribute">flex-direction</span>: column;</span><br><span class="line">	<span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 11 底部按钮文字 */</span></span><br><span class="line"><span class="selector-class">.footer-words</span> &#123;</span><br><span class="line">	<span class="attribute">text-align</span>: center;</span><br><span class="line">	<span class="attribute">background-color</span>: white;</span><br><span class="line">	<span class="attribute">padding</span>: <span class="number">20</span>upx;</span><br><span class="line">	</span><br><span class="line">	<span class="attribute">color</span>: <span class="number">#333333</span>;</span><br><span class="line">	<span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3）渲染用户信息"><a href="#3）渲染用户信息" class="headerlink" title="3）渲染用户信息"></a>3）渲染用户信息</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">onShow()&#123;</span><br><span class="line">  <span class="keyword">var</span> me = <span class="keyword">this</span>;</span><br><span class="line">  <span class="keyword">var</span> globalUser = me.getGlobalUser(<span class="string">"globalUser"</span>);</span><br><span class="line">  me.globalUser = globalUser;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-清理本地缓存-uni-clearStorageSync"><a href="#7-清理本地缓存-uni-clearStorageSync" class="headerlink" title="7 清理本地缓存 uni.clearStorageSync"></a>7 清理本地缓存 uni.clearStorageSync</h3><p>有个类似的<code>uni.removeStorage</code>是清除单个缓存。</p>
<p>页面分别对<code>清理缓存</code>和<code>注销</code>绑定了方法，实现这方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cleanStorage(e)&#123;</span><br><span class="line">  uni.clearStorageSync()</span><br><span class="line">  uni.showToast(&#123;</span><br><span class="line">    title:<span class="string">'清理缓存成功'</span>,</span><br><span class="line">    mask:<span class="literal">false</span>,</span><br><span class="line">    duration:<span class="number">1500</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8-用户退出"><a href="#8-用户退出" class="headerlink" title="8 用户退出"></a>8 用户退出</h3><p>用户退出不单单是让前端部分的缓存清理，还要经过后端去清理用户的登录态</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">logout()&#123;</span><br><span class="line">  <span class="comment">// 直接使用 vue 挂载的实例方法来获取用户信息</span></span><br><span class="line">  <span class="keyword">const</span> globalUser = <span class="keyword">this</span>.getGlobalUser(<span class="string">'globalUser'</span>)</span><br><span class="line">  uni.request(&#123;</span><br><span class="line">    url:<span class="string">'xxx?userId=$&#123;globalUser.id&#125;'</span>,</span><br><span class="line">    mthod:<span class="string">'POST'</span>,</span><br><span class="line">    success:<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">      <span class="comment">// 响应200，说明用户在后端已经完成退出</span></span><br><span class="line">      <span class="keyword">if</span> (res.data.status === <span class="number">200</span>)&#123;</span><br><span class="line">        <span class="comment">// 清理缓存</span></span><br><span class="line">        uni.removeStorageSync(<span class="string">'globalUser'</span>)</span><br><span class="line">        <span class="comment">// 页面跳转</span></span><br><span class="line">        uni.switchTab(&#123;</span><br><span class="line">          url:<span class="string">'../me/me'</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="9-用户头像相关"><a href="#9-用户头像相关" class="headerlink" title="9 用户头像相关"></a>9 用户头像相关</h3><h4 id="1）头像预览、上传和功能菜单"><a href="#1）头像预览、上传和功能菜单" class="headerlink" title="1）头像预览、上传和功能菜单"></a>1）头像预览、上传和功能菜单</h4><p>给图片绑定事件 @click，显示菜单[预览，上传]</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">operator()&#123;</span><br><span class="line">  <span class="keyword">const</span> globaUser = <span class="keyword">this</span>.getGlobalUser(<span class="string">'globalUser'</span>) <span class="comment">// 1 拿到用户数据</span></span><br><span class="line">  <span class="comment">// 2 底部弹出菜单</span></span><br><span class="line">  uni.showActionSheet(&#123;</span><br><span class="line">    itemList:[<span class="string">'查看我的头像'</span>, <span class="string">'从相册选择上传'</span>],</span><br><span class="line">    success:<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">      <span class="keyword">const</span> index = res.tapIndex</span><br><span class="line">      <span class="keyword">if</span> (index === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// 3 预览头像</span></span><br><span class="line">        <span class="keyword">var</span> faceArr = [].push(globalUser.faceImage)</span><br><span class="line">        uni.previewImage(&#123;</span><br><span class="line">          urls:faceArr, <span class="comment">// 因这个属性要数组，所以要构建一个数组</span></span><br><span class="line">          current:faceArr[<span class="number">0</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index === <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">// 4 相册中选择图片</span></span><br><span class="line">        uni.chooseImage(&#123;</span><br><span class="line">          count:<span class="number">1</span>,<span class="comment">// 最多选择张数</span></span><br><span class="line">          sizeType:[<span class="string">'compressed'</span>], <span class="comment">// 压缩还是原图</span></span><br><span class="line">          sourceType:[<span class="string">'album'</span>], <span class="comment">// 图片来源</span></span><br><span class="line">          success:<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> tempFilePath = res.tempFilePath[<span class="number">0</span>]</span><br><span class="line">            <span class="comment">// 5 拿到 图片临时路径 跳到图片选择页面</span></span><br><span class="line">            uni.navigationTo(&#123;</span><br><span class="line">              url:<span class="string">'xxx?tempFilePath=$&#123;tempFilePath&#125;'</span></span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2）头像上传和重新选择的页面"><a href="#2）头像上传和重新选择的页面" class="headerlink" title="2）头像上传和重新选择的页面"></a>2）头像上传和重新选择的页面</h4><blockquote>
<p>底部2个按钮，重选和确认。顶部标题还有文字（pages.json中改），还有返回箭头</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;view class=&quot;page page-fill&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;view class=&quot;pending-wapper&quot;&gt;</span><br><span class="line">    &lt;image id=&quot;face&quot; :src=&quot;tempFace&quot; class=&quot;pending-face&quot; mode=&quot;scaleToFill&quot;&gt;&lt;/image&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">  &lt;view class=&quot;notice&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;notice-words&quot;&gt;</span><br><span class="line">      * 请从相册中选择等比宽高的图片噢~</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">  &lt;view class=&quot;footer-opertor&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;opertor-words&quot; @click=&quot;changePendingFace&quot;&gt;</span><br><span class="line">      重新选择</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">    &lt;view class=&quot;opertor-words&quot; @click=&quot;upload&quot;&gt;</span><br><span class="line">      确认上传</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">  &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        tempFace: &quot;&quot; // 图片</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    // 1 获取传过来的图片临时路径</span><br><span class="line">    onLoad(params) &#123;</span><br><span class="line">      var tempFilePath = params.tempFilePath;</span><br><span class="line">      this.tempFace = tempFilePath;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      // 2 重新去相册中选择图片</span><br><span class="line">      changePendingFace() &#123;</span><br><span class="line">        var me = this;</span><br><span class="line">        uni.chooseImage(&#123;</span><br><span class="line">          count: 1,</span><br><span class="line">          sizeType: [&quot;compressed&quot;],</span><br><span class="line">          sourceType: [&quot;album&quot;],</span><br><span class="line">          success(res) &#123;</span><br><span class="line">            // 获得临时路径</span><br><span class="line">            var tempFilePath = res.tempFilePaths[0];</span><br><span class="line">            me.tempFace = tempFilePath;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">      // 3 确认上传功能 uni.uploadFile</span><br><span class="line">      upload() &#123;</span><br><span class="line">        var me = this;</span><br><span class="line">        // 4 用户信息，用户传递用户 id</span><br><span class="line">        var globalUser = me.getGlobalUser(&quot;globalUser&quot;);</span><br><span class="line">        // 5 上传 loading</span><br><span class="line">        uni.showLoading(&#123;</span><br><span class="line">          mask: true,</span><br><span class="line">          title: &quot;上传中，请稍后&quot;</span><br><span class="line">        &#125;);</span><br><span class="line">				// 6 上传请求</span><br><span class="line">        uni.uploadFile(&#123;</span><br><span class="line">          url: me.serverUrl + &quot;/user/uploadFace?userId=&quot; + globalUser.id, // 服务器</span><br><span class="line">          filePath: me.tempFace, // 需要上传的资源路径</span><br><span class="line">          name: &quot;file&quot;, // 文件对应的 key，服务器可以用这个 key 得到文件二进制内容</span><br><span class="line">          // 7 在 header 中增加用户 id 和 token（会话标识）</span><br><span class="line">          // token 在用户登录时拿到</span><br><span class="line">          // 在后端会同时取到到2个字段作为准入条件</span><br><span class="line">          header: &#123;</span><br><span class="line">            &quot;headerUserId&quot;: globalUser.id,</span><br><span class="line">            &quot;headerUserToken&quot;: globalUser.userUniqueToken</span><br><span class="line">          &#125;,</span><br><span class="line">          success(res) &#123;</span><br><span class="line">            var resDataStr = res.data;</span><br><span class="line">            // 8 解析 JSON 数据</span><br><span class="line">            var resData = JSON.parse(resDataStr);</span><br><span class="line">            if (resData.status == 200) &#123;</span><br><span class="line">              // 9 获得最新的用户数据</span><br><span class="line">              var userInfo = resData.data;</span><br><span class="line">              // 10 更新用户信息的缓存，并返回到之前的页面</span><br><span class="line">              uni.setStorageSync(&quot;globalUser&quot;, userInfo);</span><br><span class="line">              uni.navigateBack(&#123;</span><br><span class="line">                delta: 1</span><br><span class="line">              &#125;)</span><br><span class="line">            &#125; else if (resData.status == 502 || resData.status == 500) &#123;</span><br><span class="line">              // 11 异常提示</span><br><span class="line">              uni.showToast(&#123;</span><br><span class="line">                title: res.data.msg,</span><br><span class="line">                image: &quot;../../static/icos/error.png&quot;,</span><br><span class="line">                duration: 2000</span><br><span class="line">              &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          // 12 关闭 loading</span><br><span class="line">          complete() &#123;</span><br><span class="line">            uni.hideLoading();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">  /* 页面铺满屏幕 */</span><br><span class="line">  .page-fill &#123;</span><br><span class="line">    width:100%;</span><br><span class="line">    height: 100%;</span><br><span class="line">    position: absolute;</span><br><span class="line">    background: black;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .pending-wapper &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-direction: row;</span><br><span class="line">    justify-content: center;</span><br><span class="line"></span><br><span class="line">    margin-top: 40upx;</span><br><span class="line">  &#125;</span><br><span class="line">  .pending-face &#123;</span><br><span class="line">    width: 600upx;</span><br><span class="line">    height: 600upx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .notice &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-direction: row;</span><br><span class="line">    justify-content: flex-end;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .notice-words &#123;</span><br><span class="line">    color: gray;</span><br><span class="line">    font-size: 13px;</span><br><span class="line">    margin-top: 30upx;</span><br><span class="line">    width: 600upx;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  /* 底部操作 start */</span><br><span class="line">  .footer-opertor &#123;</span><br><span class="line">    position: fixed;</span><br><span class="line">    bottom: 0;</span><br><span class="line"></span><br><span class="line">    border-top: #515050 solid 1px;</span><br><span class="line">    width: 100%;</span><br><span class="line"></span><br><span class="line">    display: flex;</span><br><span class="line">    flex-direction: row;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line"></span><br><span class="line">    padding: 30upx;</span><br><span class="line">  &#125;</span><br><span class="line">  .opertor-words &#123;</span><br><span class="line">    color: #e8e5e5;</span><br><span class="line">    font-size: 16px;</span><br><span class="line">    width: 200upx;</span><br><span class="line">  &#125;</span><br><span class="line">  /* 底部操作 end */</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="10-其他信息修改"><a href="#10-其他信息修改" class="headerlink" title="10 其他信息修改"></a>10 其他信息修改</h3><p>每个表单的信息修改，都需要创建一个页面来操作</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1 在各个信息表单上绑定按钮事件</span></span><br><span class="line"><span class="comment">// 2 父页面触发事件， 跳转到该表单对应的修改页上</span></span><br><span class="line">uni.navigateTo(&#123;</span><br><span class="line">  url:<span class="string">'xxx'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3 子页面也是从缓存中拿到用户信息,</span></span><br><span class="line"><span class="comment">// 然后在子页面相应地方绑定数据， 一般是 input 组件</span></span><br><span class="line"><span class="comment">// 配合 button 提交按钮</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  data()&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      globalUser:&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  onLoad()&#123;</span><br><span class="line">    <span class="keyword">let</span> globalUser = <span class="keyword">this</span>.getGlobalUser(<span class="string">'globalUser'</span>)</span><br><span class="line">    <span class="keyword">this</span>.globalUser = globalUser</span><br><span class="line">  &#125;,</span><br><span class="line">  methods:&#123;</span><br><span class="line">    <span class="comment">// 4 提交事件</span></span><br><span class="line">    formSubmit(e) &#123;</span><br><span class="line">      <span class="keyword">let</span> that = <span class="keyword">this</span></span><br><span class="line">      <span class="keyword">let</span> nickname = e.detail.value.nickname</span><br><span class="line">      <span class="comment">// 5 发起修改请求(这种请求都是需要携带 token)</span></span><br><span class="line">      uni.request(&#123;</span><br><span class="line">        url:<span class="string">'xx'</span>,</span><br><span class="line">        header: &#123;</span><br><span class="line">          <span class="string">"headerUserId"</span>: that.globalUser.id,</span><br><span class="line">          <span class="string">"headerUserToken"</span>: that.globalUser.userUniqueToken</span><br><span class="line">        &#125;,</span><br><span class="line">        data:&#123;</span><br><span class="line">          userId,</span><br><span class="line">          nickname</span><br><span class="line">        &#125;,</span><br><span class="line">        method:<span class="string">'POST'</span>,</span><br><span class="line">        <span class="comment">// 6 每次申请回来都要更新用户数据</span></span><br><span class="line">        success:<span class="function">(<span class="params">&#123;data&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (data.status === <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> userInfo = data.data</span><br><span class="line">            uni.setStorageSync(<span class="string">'globalUser'</span>, userInfo)</span><br><span class="line">            uni.navigateBack(&#123;</span><br><span class="line">              delta:<span class="number">1</span></span><br><span class="line">            &#125;)</span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (data.status === <span class="number">200</span> || data.status === <span class="number">500</span>) &#123;</span><br><span class="line">            uni.showToast(&#123;</span><br><span class="line">              title:data.data.msg,</span><br><span class="line">              image:<span class="string">'error.png'</span>,</span><br><span class="line">              duration:<span class="number">2000</span></span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其他信息的修改区别，可能就是 input 的类型不一样而已。</p>
<h1 id="六、发布与上线"><a href="#六、发布与上线" class="headerlink" title="六、发布与上线"></a>六、发布与上线</h1><h2 id="（一）各平台编译发布"><a href="#（一）各平台编译发布" class="headerlink" title="（一）各平台编译发布"></a>（一）各平台编译发布</h2><h3 id="1-编译发布-H5"><a href="#1-编译发布-H5" class="headerlink" title="1 编译发布 H5"></a>1 编译发布 H5</h3><p>manifest.json 配置一下 H5 的页面标题，就可以直接发布打包了。如果不写域名，则需要自己去弄web服务器容器（打包后是运行不了的）。打包后的路径：<code>unpakcage/dist/build/h5</code></p>
<p>在HBuilder 里也有打包后的项目路径。</p>
<h3 id="2-微信小程序发布"><a href="#2-微信小程序发布" class="headerlink" title="2 微信小程序发布"></a>2 微信小程序发布</h3><h4 id="1）拿到微信开发者平台的-appid-配置一下"><a href="#1）拿到微信开发者平台的-appid-配置一下" class="headerlink" title="1）拿到微信开发者平台的 appid 配置一下"></a>1）拿到微信开发者平台的 appid 配置一下</h4><h4 id="2）发布微信小程序操作"><a href="#2）发布微信小程序操作" class="headerlink" title="2）发布微信小程序操作"></a>2）发布微信小程序操作</h4><p>会自动填入小程序名称和appid。然后重新进行编译操作</p>
<h4 id="3）等待微信开发者工具启动"><a href="#3）等待微信开发者工具启动" class="headerlink" title="3）等待微信开发者工具启动"></a>3）等待微信开发者工具启动</h4><h4 id="4）上传到微信开发者平台去审核"><a href="#4）上传到微信开发者平台去审核" class="headerlink" title="4）上传到微信开发者平台去审核"></a>4）上传到微信开发者平台去审核</h4><p>在微信开发者工具中点击<code>上传</code>， 先去掉 HTTPS 协议。</p>
<p>然后去开发者平台，去操作提交审核。</p>
<h3 id="3-APP-打包发布"><a href="#3-APP-打包发布" class="headerlink" title="3 APP 打包发布"></a>3 APP 打包发布</h3><h4 id="1）SDK配置"><a href="#1）SDK配置" class="headerlink" title="1）SDK配置"></a>1）SDK配置</h4><p>需要获取各个平台的 appid 之类的参数配置</p>
<h4 id="2）基本配置"><a href="#2）基本配置" class="headerlink" title="2）基本配置"></a>2）基本配置</h4><p>APP名称，图标等。</p>
<p>app启动图配置。</p>
<p>app模块授权配置。</p>
<h4 id="3）安卓app打包"><a href="#3）安卓app打包" class="headerlink" title="3）安卓app打包"></a>3）安卓app打包</h4><p>原生app云打包。选择安卓，使用 DCLOUD 证书。是提供给平台打包的，不是在本地的。所以要等待打包后的下载地址。</p>
<h4 id="4）IOS-打包"><a href="#4）IOS-打包" class="headerlink" title="4）IOS 打包"></a>4）IOS 打包</h4><p>选择IOS， 支持ipone，使用苹果证书（需要注册苹果开发者，要花钱），然后有一个 apple appid（该id还对应个秘钥），填入证书原件。</p>
<p>若是选择越狱。就不用选证书了。可以直接打包。也是提交到打包服务器，然后提供给我们下载的URL。</p>
<h2 id="（二）服务器准备-nginx"><a href="#（二）服务器准备-nginx" class="headerlink" title="（二）服务器准备 + nginx"></a>（二）服务器准备 + nginx</h2><p>购买云服务器，就有一个公网IP。然后整个云服务器就是作为一个使用实例。</p>
<h3 id="1-安全组（防火墙）"><a href="#1-安全组（防火墙）" class="headerlink" title="1 安全组（防火墙）"></a>1 安全组（防火墙）</h3><p>每台机器都有防火墙，在云服务器里就是安全组。可以自定义规则（端口的开放情况）</p>
<blockquote>
<p>一些软件都有固定的连接端口，所以要打开相应的端口</p>
</blockquote>
<p>一般会有<code>一键放通</code>功能，就是自动打开一些常用的端口</p>
<ul>
<li>22(linux), 3389, ICMP, 80（http请求默认）, 443(ssr), 20, 21</li>
</ul>
<p>也会有 <code>all</code> 的配置选项，建议直接删除这个规则。不需要开放所有端口</p>
<h3 id="2-设定服务器实例密码"><a href="#2-设定服务器实例密码" class="headerlink" title="2 设定服务器实例密码"></a>2 设定服务器实例密码</h3><p>可以对服务器设定连接密码。用户名一般是 <code>root</code>。</p>
<h3 id="3-传送-nginx-到服务器，使用-filezilla-工具"><a href="#3-传送-nginx-到服务器，使用-filezilla-工具" class="headerlink" title="3 传送 nginx 到服务器，使用 filezilla 工具"></a>3 传送 nginx 到服务器，使用 filezilla 工具</h3><p>基本操作就是，输入主机名（公网IP地址）+用户名（一般默认是root）+密码+端口（linux默认22）</p>
<ul>
<li>左边是本地pc目录，右边是服务器linux目录</li>
<li>就是将 nginx.tar.gz 包拉到右边，一般是 <code>home</code>目录装软件</li>
</ul>
<h2 id="（三）服务器环境搭建"><a href="#（三）服务器环境搭建" class="headerlink" title="（三）服务器环境搭建"></a>（三）服务器环境搭建</h2><h3 id="1-PuTTY-和-SecureCRT-连接服务器"><a href="#1-PuTTY-和-SecureCRT-连接服务器" class="headerlink" title="1 PuTTY 和 SecureCRT 连接服务器"></a>1 PuTTY 和 SecureCRT 连接服务器</h3><blockquote>
<p>2个选一个就行，这里选 CRT</p>
</blockquote>
<h4 id="1）新建会话"><a href="#1）新建会话" class="headerlink" title="1）新建会话"></a>1）新建会话</h4><p>输入主机名+端口+用户名</p>
<h4 id="2）会话名称"><a href="#2）会话名称" class="headerlink" title="2）会话名称"></a>2）会话名称</h4><p>一般是 ip + 应用名字</p>
<h4 id="3）连接输入密码"><a href="#3）连接输入密码" class="headerlink" title="3）连接输入密码"></a>3）连接输入密码</h4><h4 id="4）调整对话框的字体等样式"><a href="#4）调整对话框的字体等样式" class="headerlink" title="4）调整对话框的字体等样式"></a>4）调整对话框的字体等样式</h4><p>选项 - 字体设置</p>
<h3 id="2-通过命令操作服务器"><a href="#2-通过命令操作服务器" class="headerlink" title="2 通过命令操作服务器"></a>2 通过命令操作服务器</h3><h4 id="1）找到并解压-nginx"><a href="#1）找到并解压-nginx" class="headerlink" title="1）找到并解压 nginx"></a>1）找到并解压 nginx</h4><ul>
<li>cd /， 进入根目录</li>
<li>ls， 列出目录</li>
<li>cd home， 进入 home 目录。找到刚才 nginx</li>
<li>解压 tar 包， <code>tar -zxvf nginx-1xx.tar.gz</code>（ 按 tab 可以补全文件名）</li>
</ul>
<h4 id="2）安装-nginx-基础运行环境"><a href="#2）安装-nginx-基础运行环境" class="headerlink" title="2）安装 nginx 基础运行环境"></a>2）安装 nginx 基础运行环境</h4><ul>
<li><p><code>yum -y install gcc-c++</code>， 安装nginx必须的运行环境</p>
</li>
<li><p><code>yum -y install pcre-devel</code></p>
</li>
<li><p><code>yum -y install zlib-devel</code></p>
</li>
<li><p><code>yum -y install openssl opensll-devel</code></p>
</li>
</ul>
<h4 id="3）安装-nginx"><a href="#3）安装-nginx" class="headerlink" title="3）安装 nginx"></a>3）安装 nginx</h4><ul>
<li><code>ll</code>， 看home目录下，nginx 解压后的文件目录名</li>
<li><code>cd nginx-1.12.0/</code>（解压后的nginx目录，都是一些源码）</li>
<li><code>./configure</code>，执行该命令配置基础环境（nginx自带的源码）</li>
<li><code>make</code>，编译一下这些nginx源码</li>
<li><code>make install</code>，安装 nginx（会安装到 /usr/local/…）</li>
<li><code>cd /usr/local</code>进入后，用 ll 命令看是否有 nginx 目录</li>
<li><code>cd nginx</code> 真正进入到 nginx 目录， 然后 <code>ll</code>看当前目录下的内容<ul>
<li>conf</li>
<li>html</li>
<li>logs</li>
<li>sbin</li>
</ul>
</li>
<li><code>pwd</code>，看当前所在的目录路径</li>
<li><code>cd sbin</code>进入目录，然后 <code>ll</code>看到只有一个 nginx</li>
<li><code>./nginx</code> 启动 nginx</li>
</ul>
<p>到此，可以复制服务器的公网 IP 访问，能看到 Nginx 默认显示信息。</p>
<h3 id="3-部署-H5-项目"><a href="#3-部署-H5-项目" class="headerlink" title="3 部署 H5 项目"></a>3 部署 H5 项目</h3><p>找到刚才 nginx 的安装路径，一般是在 <code>/usr/local/nginx</code></p>
<p>然后，创建一个目录，用于存放我们的项目，<code>usr/local/nginx/project</code></p>
<p>复制本地打包出来的H5项目，就是 dist 下的整个 h5 目录，复制进服务器的 <code>project</code>目录下</p>
<h3 id="4-配置-nginx"><a href="#4-配置-nginx" class="headerlink" title="4 配置 nginx"></a>4 配置 nginx</h3><blockquote>
<p>在 nginx 目录下，有个 conf 配置文件目录</p>
</blockquote>
<ul>
<li><code>cd conf/</code>，进入配置文件目录， <code>ll</code>后找到 <code>nginx.conf</code>这就是 nginx 的 web 服务配置文件</li>
<li>修改该配置文件的方式<ul>
<li>复制到本机，文本方式修改</li>
<li>服务器<code>vim nginx.conf</code>，编辑器打开</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1 键盘找到 "server" 配置对象，按 a 键进入编辑模式， 按 esc 退出， :wq 保存退出</span></span><br><span class="line">server &#123;</span><br><span class="line">  listen:<span class="number">81</span>; <span class="comment">// 2 从默认的 80 改成 81，这个要看服务器开启了什么端口</span></span><br><span class="line">  server_name localhost; <span class="comment">//  本地</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 3 增加一台服务配置</span></span><br><span class="line">server &#123;</span><br><span class="line">  listen:<span class="number">80</span>;</span><br><span class="line">  server_name errorje.cn; <span class="comment">// 4 可以配置域名</span></span><br><span class="line">  <span class="comment">// 5 配置项目页面路径， 匹配 / 路径</span></span><br><span class="line">  location / &#123;</span><br><span class="line">    root /usr/local/nginx/movie/h5; <span class="comment">// 就是项目的目录。可以在连接服务器工具上复制该路径</span></span><br><span class="line">    index index.html; <span class="comment">// 匹配的访问首页</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-重启-nginx-服务器"><a href="#5-重启-nginx-服务器" class="headerlink" title="5 重启 nginx 服务器"></a>5 重启 nginx 服务器</h3><p>进入 <code>sbin</code> 目录，执行 <code>./nginx -t</code>测试，来验证当前配置文件是否正确</p>
<p>若配置文件是正确的范阔，则执行重启服务器让配置文件生效 <code>./nginx -s reload</code></p>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>坚持原创技术分享，您的支持将鼓励我继续创作！</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/path/to/error_wepay.png" alt="ErrorJE 微信支付">
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/path/to/error_alipay.jpg" alt="ErrorJE 支付宝">
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/移动端/uni-app框架了解/" rel="next" title="uni-app框架了解">
                <i class="fa fa-chevron-left"></i> uni-app框架了解
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      
        <div id="gitment-container"></div>
      
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/errorje.png" alt="ErrorJE">
            
              <p class="site-author-name" itemprop="name">ErrorJE</p>
              <p class="site-description motion-element" itemprop="description">ErrorJE's FE Blog</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/ErrorJe" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#一、项目基础配置"><span class="nav-number">1.</span> <span class="nav-text">一、项目基础配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-HBuilderX-工具"><span class="nav-number">1.0.1.</span> <span class="nav-text">1 HBuilderX 工具</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-开发平台"><span class="nav-number">1.0.2.</span> <span class="nav-text">2 开发平台</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-套路样式说明"><span class="nav-number">1.0.3.</span> <span class="nav-text">3 套路样式说明</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）全局样式"><span class="nav-number">1.0.3.1.</span> <span class="nav-text">1）全局样式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）引入外部样式"><span class="nav-number">1.0.3.2.</span> <span class="nav-text">2）引入外部样式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3）文字超出省略显示"><span class="nav-number">1.0.3.3.</span> <span class="nav-text">3）文字超出省略显示</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4）flex-嵌套布局"><span class="nav-number">1.0.3.4.</span> <span class="nav-text">4）flex 嵌套布局</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5）阴影实现"><span class="nav-number">1.0.3.5.</span> <span class="nav-text">5）阴影实现</span></a></li></ol></li></ol></li></ol><li class="nav-item nav-level-1"><a class="nav-link" href="#二、框架基础"><span class="nav-number">2.</span> <span class="nav-text">二、框架基础</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#（一）项目结构与文件类型（MVVM思想）"><span class="nav-number">2.1.</span> <span class="nav-text">（一）项目结构与文件类型（MVVM思想）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-MVC"><span class="nav-number">2.1.1.</span> <span class="nav-text">1 MVC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-MVVC"><span class="nav-number">2.1.2.</span> <span class="nav-text">2 MVVC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-数据双向绑定"><span class="nav-number">2.1.3.</span> <span class="nav-text">3 数据双向绑定</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）项目结构"><span class="nav-number">2.1.3.1.</span> <span class="nav-text">1）项目结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）双向绑定"><span class="nav-number">2.1.3.2.</span> <span class="nav-text">2）双向绑定</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#（二）全局（页面）标题（样式）与路由配置"><span class="nav-number">2.2.</span> <span class="nav-text">（二）全局（页面）标题（样式）与路由配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-路由配置"><span class="nav-number">2.2.1.</span> <span class="nav-text">1 路由配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-页面标题"><span class="nav-number">2.2.2.</span> <span class="nav-text">2 页面标题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-全局标题"><span class="nav-number">2.2.3.</span> <span class="nav-text">3 全局标题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-开启下拉刷新和触底分页-配合-Loading"><span class="nav-number">2.2.4.</span> <span class="nav-text">4 开启下拉刷新和触底分页(配合 Loading)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）Pages-json-开启页面的-style-属性"><span class="nav-number">2.2.4.1.</span> <span class="nav-text">1）Pages.json 开启页面的 style 属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）页面中增加响应事件和-loading"><span class="nav-number">2.2.4.2.</span> <span class="nav-text">2）页面中增加响应事件和 loading</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-沉浸渐进式标题导航栏"><span class="nav-number">2.2.5.</span> <span class="nav-text">5 沉浸渐进式标题导航栏</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-顶部导航栏"><span class="nav-number">2.2.6.</span> <span class="nav-text">6 顶部导航栏</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）顶部导航栏"><span class="nav-number">2.2.6.1.</span> <span class="nav-text">1）顶部导航栏</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）顶部自定义按钮"><span class="nav-number">2.2.6.2.</span> <span class="nav-text">2）顶部自定义按钮</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#（三）App（页面）的生命周期"><span class="nav-number">2.3.</span> <span class="nav-text">（三）App（页面）的生命周期</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-应用生命周期"><span class="nav-number">2.3.1.</span> <span class="nav-text">1 应用生命周期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-页面生命周期"><span class="nav-number">2.3.2.</span> <span class="nav-text">2 页面生命周期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-页面跳转组件"><span class="nav-number">2.3.3.</span> <span class="nav-text">3 页面跳转组件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#（四）数据绑定与事件和组件动静态变量"><span class="nav-number">2.4.</span> <span class="nav-text">（四）数据绑定与事件和组件动静态变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#（五）条件和列表渲染语法"><span class="nav-number">2.5.</span> <span class="nav-text">（五）条件和列表渲染语法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-条件渲染"><span class="nav-number">2.5.1.</span> <span class="nav-text">1 条件渲染</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-列表渲染"><span class="nav-number">2.5.2.</span> <span class="nav-text">2 列表渲染</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#（六）多端兼容条件编译"><span class="nav-number">2.6.</span> <span class="nav-text">（六）多端兼容条件编译</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-基本语义"><span class="nav-number">2.6.1.</span> <span class="nav-text">1 基本语义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-平台类别"><span class="nav-number">2.6.2.</span> <span class="nav-text">2 平台类别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-使用方式"><span class="nav-number">2.6.3.</span> <span class="nav-text">3 使用方式</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#三、组件"><span class="nav-number">3.</span> <span class="nav-text">三、组件</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#（一）普通官网组件"><span class="nav-number">3.1.</span> <span class="nav-text">（一）普通官网组件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-tabBar-底部栏"><span class="nav-number">3.1.1.</span> <span class="nav-text">1 tabBar 底部栏</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-view-视图组件"><span class="nav-number">3.1.2.</span> <span class="nav-text">2 view 视图组件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-swiper-轮播图组件"><span class="nav-number">3.1.3.</span> <span class="nav-text">3 swiper 轮播图组件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-scroll-view-滚动区域"><span class="nav-number">3.1.4.</span> <span class="nav-text">4 scroll-view 滚动区域</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-video-视频组件"><span class="nav-number">3.1.5.</span> <span class="nav-text">5 video 视频组件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）切页时的视频控制-uni-createVideoContext"><span class="nav-number">3.1.5.1.</span> <span class="nav-text">1）切页时的视频控制 uni.createVideoContext</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）禁止视频同时播放"><span class="nav-number">3.1.5.2.</span> <span class="nav-text">2）禁止视频同时播放</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-input-输入框"><span class="nav-number">3.1.6.</span> <span class="nav-text">6 input 输入框</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-image-图片资源"><span class="nav-number">3.1.7.</span> <span class="nav-text">7 image 图片资源</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-表单组件"><span class="nav-number">3.1.8.</span> <span class="nav-text">8 表单组件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）按钮组件-button"><span class="nav-number">3.1.8.1.</span> <span class="nav-text">1）按钮组件 button</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）form-表单"><span class="nav-number">3.1.8.2.</span> <span class="nav-text">2）form 表单</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#（二）自定义组件"><span class="nav-number">3.2.</span> <span class="nav-text">（二）自定义组件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-自定义组件的开发"><span class="nav-number">3.2.1.</span> <span class="nav-text">1 自定义组件的开发</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）创建组件"><span class="nav-number">3.2.1.1.</span> <span class="nav-text">1）创建组件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）定义组件名称"><span class="nav-number">3.2.1.2.</span> <span class="nav-text">2）定义组件名称</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3）使用自定义组件"><span class="nav-number">3.2.1.3.</span> <span class="nav-text">3）使用自定义组件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-组件间传值"><span class="nav-number">3.2.2.</span> <span class="nav-text">2 组件间传值</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）父传子"><span class="nav-number">3.2.2.1.</span> <span class="nav-text">1）父传子</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#四、API"><span class="nav-number">4.</span> <span class="nav-text">四、API</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-发起请求-uni-request"><span class="nav-number">4.0.1.</span> <span class="nav-text">1 发起请求 uni.request</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-路由跳转-uni-navigateTo"><span class="nav-number">4.0.2.</span> <span class="nav-text">2 路由跳转 uni.navigateTo</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-图片预览-uni-previewImage"><span class="nav-number">4.0.3.</span> <span class="nav-text">3 图片预览 uni.previewImage</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）自定义预览组件实现"><span class="nav-number">4.0.3.1.</span> <span class="nav-text">1）自定义预览组件实现</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）路由跳转到自定义组件页面"><span class="nav-number">4.0.3.2.</span> <span class="nav-text">2）路由跳转到自定义组件页面</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3）增加图片交互功能-uni-showActionSheet"><span class="nav-number">4.0.3.3.</span> <span class="nav-text">3）增加图片交互功能 uni.showActionSheet</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-下载资源到本地"><span class="nav-number">4.0.4.</span> <span class="nav-text">4 下载资源到本地</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）下载资源-uni-downLoadFile-（跨域）"><span class="nav-number">4.0.4.1.</span> <span class="nav-text">1）下载资源 uni.downLoadFile （跨域）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）保存图片到本地-uni-saveImageToPhotosAlbum"><span class="nav-number">4.0.4.2.</span> <span class="nav-text">2）保存图片到本地 uni.saveImageToPhotosAlbum</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-第三方登录-uni-login"><span class="nav-number">4.0.5.</span> <span class="nav-text">5 第三方登录 uni.login</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）微信小程序登录"><span class="nav-number">4.0.5.1.</span> <span class="nav-text">1）微信小程序登录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）APP-登录"><span class="nav-number">4.0.5.2.</span> <span class="nav-text">2）APP 登录</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-插件使用"><span class="nav-number">4.0.6.</span> <span class="nav-text">6 插件使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）图片剪裁"><span class="nav-number">4.0.6.1.</span> <span class="nav-text">1）图片剪裁</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#五、业务处理"><span class="nav-number">5.</span> <span class="nav-text">五、业务处理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#（一）全局变量和状态"><span class="nav-number">5.1.</span> <span class="nav-text">（一）全局变量和状态</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-全局变量-公共组件"><span class="nav-number">5.1.1.</span> <span class="nav-text">1 全局变量 - 公共组件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）创建-common-目录"><span class="nav-number">5.1.1.1.</span> <span class="nav-text">1）创建 common 目录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）导入-common-并使用"><span class="nav-number">5.1.1.2.</span> <span class="nav-text">2）导入 common 并使用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-全局变量-Vue-prototype"><span class="nav-number">5.1.2.</span> <span class="nav-text">2 全局变量 - Vue.prototype</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）main-js-扩展-Vue-实例"><span class="nav-number">5.1.2.1.</span> <span class="nav-text">1）main.js 扩展 Vue 实例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）从实例中拿"><span class="nav-number">5.1.2.2.</span> <span class="nav-text">2）从实例中拿</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#（二）数据处理"><span class="nav-number">5.2.</span> <span class="nav-text">（二）数据处理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-data-自定义属性"><span class="nav-number">5.2.1.</span> <span class="nav-text">1 :data-* 自定义属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-分页处理"><span class="nav-number">5.2.2.</span> <span class="nav-text">2 分页处理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）通用参数"><span class="nav-number">5.2.2.1.</span> <span class="nav-text">1）通用参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）请求和分页逻辑"><span class="nav-number">5.2.2.2.</span> <span class="nav-text">2）请求和分页逻辑</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-data-复杂数据加载"><span class="nav-number">5.2.3.</span> <span class="nav-text">3 data 复杂数据加载</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#（三）页面控制"><span class="nav-number">5.3.</span> <span class="nav-text">（三）页面控制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-动画创建-uni-createAnimation"><span class="nav-number">5.3.1.</span> <span class="nav-text">1 动画创建 - uni.createAnimation</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）创建动画数据对象"><span class="nav-number">5.3.1.1.</span> <span class="nav-text">1）创建动画数据对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）挂载到组件元素属性上"><span class="nav-number">5.3.1.2.</span> <span class="nav-text">2）挂载到组件元素属性上</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3）样式设置"><span class="nav-number">5.3.1.3.</span> <span class="nav-text">3）样式设置</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-类似搜索框的样式实现"><span class="nav-number">5.3.2.</span> <span class="nav-text">2 类似搜索框的样式实现</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#（四）用户页面"><span class="nav-number">5.4.</span> <span class="nav-text">（四）用户页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-登录显示"><span class="nav-number">5.4.1.</span> <span class="nav-text">1 登录显示</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-用户登录页面"><span class="nav-number">5.4.2.</span> <span class="nav-text">2 用户登录页面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-发起登录请求-uni-request"><span class="nav-number">5.4.3.</span> <span class="nav-text">3 发起登录请求 uni.request</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-用户信息缓存-uni-setStorageSync-和登录失败"><span class="nav-number">5.4.4.</span> <span class="nav-text">4 用户信息缓存 uni.setStorageSync 和登录失败</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-拿到缓存中的用户信息-uni-getStorageSync"><span class="nav-number">5.4.5.</span> <span class="nav-text">5 拿到缓存中的用户信息 uni.getStorageSync</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-用户个人信息详情页"><span class="nav-number">5.4.6.</span> <span class="nav-text">6 用户个人信息详情页</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）页面骨架"><span class="nav-number">5.4.6.1.</span> <span class="nav-text">1）页面骨架</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）CSS-样式控制"><span class="nav-number">5.4.6.2.</span> <span class="nav-text">2）CSS 样式控制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3）渲染用户信息"><span class="nav-number">5.4.6.3.</span> <span class="nav-text">3）渲染用户信息</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-清理本地缓存-uni-clearStorageSync"><span class="nav-number">5.4.7.</span> <span class="nav-text">7 清理本地缓存 uni.clearStorageSync</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-用户退出"><span class="nav-number">5.4.8.</span> <span class="nav-text">8 用户退出</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-用户头像相关"><span class="nav-number">5.4.9.</span> <span class="nav-text">9 用户头像相关</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）头像预览、上传和功能菜单"><span class="nav-number">5.4.9.1.</span> <span class="nav-text">1）头像预览、上传和功能菜单</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）头像上传和重新选择的页面"><span class="nav-number">5.4.9.2.</span> <span class="nav-text">2）头像上传和重新选择的页面</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-其他信息修改"><span class="nav-number">5.4.10.</span> <span class="nav-text">10 其他信息修改</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#六、发布与上线"><span class="nav-number">6.</span> <span class="nav-text">六、发布与上线</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#（一）各平台编译发布"><span class="nav-number">6.1.</span> <span class="nav-text">（一）各平台编译发布</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-编译发布-H5"><span class="nav-number">6.1.1.</span> <span class="nav-text">1 编译发布 H5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-微信小程序发布"><span class="nav-number">6.1.2.</span> <span class="nav-text">2 微信小程序发布</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）拿到微信开发者平台的-appid-配置一下"><span class="nav-number">6.1.2.1.</span> <span class="nav-text">1）拿到微信开发者平台的 appid 配置一下</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）发布微信小程序操作"><span class="nav-number">6.1.2.2.</span> <span class="nav-text">2）发布微信小程序操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3）等待微信开发者工具启动"><span class="nav-number">6.1.2.3.</span> <span class="nav-text">3）等待微信开发者工具启动</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4）上传到微信开发者平台去审核"><span class="nav-number">6.1.2.4.</span> <span class="nav-text">4）上传到微信开发者平台去审核</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-APP-打包发布"><span class="nav-number">6.1.3.</span> <span class="nav-text">3 APP 打包发布</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）SDK配置"><span class="nav-number">6.1.3.1.</span> <span class="nav-text">1）SDK配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）基本配置"><span class="nav-number">6.1.3.2.</span> <span class="nav-text">2）基本配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3）安卓app打包"><span class="nav-number">6.1.3.3.</span> <span class="nav-text">3）安卓app打包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4）IOS-打包"><span class="nav-number">6.1.3.4.</span> <span class="nav-text">4）IOS 打包</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#（二）服务器准备-nginx"><span class="nav-number">6.2.</span> <span class="nav-text">（二）服务器准备 + nginx</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-安全组（防火墙）"><span class="nav-number">6.2.1.</span> <span class="nav-text">1 安全组（防火墙）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-设定服务器实例密码"><span class="nav-number">6.2.2.</span> <span class="nav-text">2 设定服务器实例密码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-传送-nginx-到服务器，使用-filezilla-工具"><span class="nav-number">6.2.3.</span> <span class="nav-text">3 传送 nginx 到服务器，使用 filezilla 工具</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#（三）服务器环境搭建"><span class="nav-number">6.3.</span> <span class="nav-text">（三）服务器环境搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-PuTTY-和-SecureCRT-连接服务器"><span class="nav-number">6.3.1.</span> <span class="nav-text">1 PuTTY 和 SecureCRT 连接服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）新建会话"><span class="nav-number">6.3.1.1.</span> <span class="nav-text">1）新建会话</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）会话名称"><span class="nav-number">6.3.1.2.</span> <span class="nav-text">2）会话名称</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3）连接输入密码"><span class="nav-number">6.3.1.3.</span> <span class="nav-text">3）连接输入密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4）调整对话框的字体等样式"><span class="nav-number">6.3.1.4.</span> <span class="nav-text">4）调整对话框的字体等样式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-通过命令操作服务器"><span class="nav-number">6.3.2.</span> <span class="nav-text">2 通过命令操作服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1）找到并解压-nginx"><span class="nav-number">6.3.2.1.</span> <span class="nav-text">1）找到并解压 nginx</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2）安装-nginx-基础运行环境"><span class="nav-number">6.3.2.2.</span> <span class="nav-text">2）安装 nginx 基础运行环境</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3）安装-nginx"><span class="nav-number">6.3.2.3.</span> <span class="nav-text">3）安装 nginx</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-部署-H5-项目"><span class="nav-number">6.3.3.</span> <span class="nav-text">3 部署 H5 项目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-配置-nginx"><span class="nav-number">6.3.4.</span> <span class="nav-text">4 配置 nginx</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-重启-nginx-服务器"><span class="nav-number">6.3.5.</span> <span class="nav-text">5 重启 nginx 服务器</span></a></li></ol></li></ol></li></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<div class="copyright">&copy; 2019.07 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ErrorJE</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">17.2k</span>
  
</div>



  <div class="theme-info">原创笔记和文章 </div>






        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"> 本站访客数</i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"> 本站阅读量</i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      <i> 次</i>
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    
      <style>
        a.gitment-editor-footer-tip { display: none; }
        .gitment-container.gitment-footer-container { display: none; }
      </style>
    

    
      <script type="text/javascript">
      function renderGitment(){
        var gitment = new Gitmint({
            id: window.location.pathname, 
            owner: 'ErrorJe',
            repo: 'ErrorJE.github.io',
            
            lang: "" || navigator.language || navigator.systemLanguage || navigator.userLanguage,
            
            oauth: {
            
            
                client_secret: '83278e1b95e23002e8e3911178c6f09f6b30d1a1',
            
                client_id: '7899390d88d21ead4a2d'
            }});
        gitment.render('gitment-container');
      }

      
      renderGitment();
      
      </script>
    







  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
